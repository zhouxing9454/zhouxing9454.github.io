<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="纸鸢">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
        
        
        
            <link rel="preconnect" href="https://registry.npmmirror.com" crossorigin>
        
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://zhouxing9454.github.io/2023/03/25/go设计模式/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="GO设计模式">
<meta property="og:url" content="https://zhouxing9454.github.io/2023/03/25/GO%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index.html">
<meta property="og:site_name" content="Olivia的小跟班">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zhouxing9454.github.io/images/redefine-og.webp">
<meta property="article:published_time" content="2023-03-25T03:43:58.000Z">
<meta property="article:modified_time" content="2023-05-26T19:46:58.000Z">
<meta property="article:author" content="Olivia的小跟班">
<meta property="article:tag" content="设计模式">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zhouxing9454.github.io/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/background-img/fluid.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/background-img/fluid.png">
    <meta name="theme-color" content="#1890ff">
    <link rel="shortcut icon" href="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/background-img/fluid.png">
    <!--- Page Info-->
    
    <title>
        
            GO设计模式 | Olivia的小跟班
        
    </title>

    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Chillax/chillax.css">

    <!--- Inject Part-->
    
        
            
    
            
    

    
<link rel="stylesheet" href="/css/style.css">


    
        <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/css/build/tailwind.css">
    

    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/GeistMono/geist-mono.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fonts/Geist/geist.css">
    <!--- Font Part-->
    
    
    
    
    
    
        <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/anime.min.js" ></script>
    

    <script id="hexo-configurations">
    window.config = {"hostname":"zhouxing9454.github.io","root":"/","language":"zh-CN"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"5rem","h2":"4rem","h3":"2.8rem","h4":"2.5rem","h5":"2.2rem","h6":"2rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":null,"skip_dirs":[]}},"colors":{"primary":"#1890ff","secondary":"#1890ff","default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":true,"custom_message":null},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://blog-1314857283.cos.ap-shanghai.myqcloud.com/background-img/light-background.png","dark":"https://blog-1314857283.cos.ap-shanghai.myqcloud.com/background-img/back1.png"},"title":"Talk is cheap,Show me the code.","subtitle":{"text":["他们以为击败我就是终结，而我必归来将之改写。"],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#D27D2D","dark":"#1E90FF"},"text_style":{"title_size":"2.1rem","subtitle_size":"1.2rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"default","links":{"github":"https://github.com/zhouxing9454","instagram":null,"zhihu":null,"twitter":null,"qq":"https://blog-1314857283.cos.ap-shanghai.myqcloud.com/background-img/QQ.jpg","weixin":"https://blog-1314857283.cos.ap-shanghai.myqcloud.com/background-img/wechat.jpg","email":"zhouxing9454@gmail.com"},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":true,"type":"fixed","audios":[{"name":"最后的旅行","artist":"Rainton桐","url":"http://music.163.com/song/media/outer/url?id=30512539.mp3","cover":"https://p1.music.126.net/XWUdXb46hIdIecRihPCV_A==/109951168667887853.jpg"}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#FAF9F6","right":"#FAF9F6","transparency":50},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Tags":{"icon":"fa-solid fa-tags","path":"/tags/"},"Categories":{"icon":"fa-solid fa-folder","path":"/categories/"},"Friends":{"icon":"fa-solid fa-link","path":"/links/"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur","typography":{"line_height":1.6}},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/7/4 9:30:00"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/fontawesome.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/brands.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/solid.min.css">
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/fontawesome/regular.min.css">
    
    
    
    
<meta name="generator" content="Hexo 7.1.1"></head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    <h2 class="ml13">
        Olivia的小跟班
    </h2>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }
    </script>
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Olivia的小跟班
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags/"
                                        >
                                    <i class="fa-solid fa-tags fa-fw"></i>
                                    标签
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories/"
                                        >
                                    <i class="fa-solid fa-folder fa-fw"></i>
                                    分类
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/links/"
                                        >
                                    <i class="fa-solid fa-link fa-fw"></i>
                                    友情链接
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags/"
                        >
                            <span>
                                标签
                            </span>
                            
                                <i class="fa-solid fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories/"
                        >
                            <span>
                                分类
                            </span>
                            
                                <i class="fa-solid fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/links/"
                        >
                            <span>
                                友情链接
                            </span>
                            
                                <i class="fa-solid fa-link fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">20</div>
        <div class="label text-third-text-color text-sm">标签</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">20</div>
        <div class="label text-third-text-color text-sm">分类</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">43</div>
        <div class="label text-third-text-color text-sm">文章</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">GO设计模式</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/background-img/avatar.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">纸鸢</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv4</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-03-25 11:43:58</span>
        <span class="mobile">2023-03-25 11:43:58</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2023-05-27 03:46:58</span>
            <span class="mobile">2023-05-27 03:46:58</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h1 id="题记"><a href="#题记" class="headerlink" title="题记"></a>题记</h1><p>本文参考了<a class="link"   target="_blank" rel="noopener" href="https://www.yuque.com/aceld/lfhu8y" >刘丹冰的Easy搞定Golang设计模式<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>本文有关设计模式的实现请<a class="link"   target="_blank" rel="noopener" href="https://github.com/zhouxing9454/Design_Pattern" >访问<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<h1 id="一、设计模式概述"><a href="#一、设计模式概述" class="headerlink" title="一、设计模式概述"></a>一、设计模式概述</h1><p>修习软件开发比作武功修炼，可以分成招式和内功两部分。</p>
<p>招式：</p>
<ul>
<li>编程语言</li>
<li>开发工具</li>
<li>框架技术</li>
</ul>
<p>内功：</p>
<ul>
<li>数据结构</li>
<li>算法</li>
<li><strong>设计模式</strong></li>
<li>架构设计</li>
<li>软件工程</li>
</ul>
<p>注意：招式可以很快学会，但是内功的修炼需要更长的时间。</p>
<h3 id="1-1设计模式从何而来"><a href="#1-1设计模式从何而来" class="headerlink" title="1.1设计模式从何而来"></a>1.1设计模式从何而来</h3><p>克里斯托弗.亚历山大在作品《建筑的永恒之道》中对“模式”的描述是：“每个模式都描述了一个在我们的环境中不断出现的问题，然后描述了该问题的解决方案的核心，通过这种方式，我们可以无数次地重用那些已有的成功的解决方案，无须再重复相同的工作。”他给出了设计模式的定义。我们也可以用下面这句话来理解“设计模式”的定义：“<strong>设计模式是在特定环境下人们解决某类重复出现问题的一套成功或有效的解决方案。</strong>”</p>
<h3 id="1-2-软件设计模式又从何而来"><a href="#1-2-软件设计模式又从何而来" class="headerlink" title="1.2 软件设计模式又从何而来"></a>1.2 软件设计模式又从何而来</h3><p>GoF —（Ralph Johnson，Richard Helm，Erich Gamma，John Vlissides）</p>
<p>​		GoF将模式的概念引入软件工程领域，这标志着软件模式的诞生。软件模式(Software Patterns)是将模式的一般概念应用于软件开发领域，即软件开发的总体指导思路或参照样板。软件模式并非仅限于设计模式，还包括架构模式、分析模式和过程模式等，实际上，在软件开发生命周期的每一个阶段都存在着一些被认同的模式。软件模式与具体的应用领域无关，也就是说无论你从事的是移动应用开发、桌面应用开发、Web应用开发还是嵌入式软件的开发，都可以使用软件模式。无论你是使用Java、C#、Objective-C、VB.net、Smalltalk等纯面向对象编程语言，还是使用C++、PHP、Delphi、JavaScript等可支持面向对象编程的语言，你都需要了解软件设计模式！<br>​		GoF给软件设计模式提供了定义，如下：“软件设计模式(Design Pattern)是一套被反复使用、多数人知晓的、经过分类编目的、代码设计经验的总结，使用设计模式是为了可重用代码、让代码更容易被他人理解并且保证代码可靠性。”</p>
<p>​		<strong>一句大白话可以总结：“在一定环境下，用固定套路解决问题。”</strong></p>
<h3 id="1-3-软件设计模式的种类"><a href="#1-3-软件设计模式的种类" class="headerlink" title="1.3 软件设计模式的种类"></a>1.3 软件设计模式的种类</h3><p>GoF提出的设计模式有23个，包括：</p>
<p>（1）创建型(Creational)模式：如何创建对象；</p>
<p>（2）结构型(Structural )模式：如何实现类或对象的组合；</p>
<p>（3）行为型(Behavioral)模式：类或对象怎样交互以及怎样分配职责。</p>
<p>有一个“简单工厂模式”不属于GoF 23种设计模式，但大部分的设计模式书籍都会对它进行专门的介绍。设计模式目前种类： GoF的23种   + “简单工厂模式” &#x3D; 24种。</p>
<h3 id="1-4-软件设计模式的作用"><a href="#1-4-软件设计模式的作用" class="headerlink" title="1.4 软件设计模式的作用"></a>1.4 软件设计模式的作用</h3><p>那么对于初学者来说，学习设计模式将有助于更加深入地理解面向对象思想, 让你知道：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 如何将代码分散在几个不同的类中？</span><br><span class="line">2. 为什么要有“接口”？</span><br><span class="line">3. 何谓针对抽象编程？</span><br><span class="line">4. 何时不应该使用继承？</span><br><span class="line">5. 如何不修改源代码增加新功能？</span><br><span class="line">6. 更好地阅读和理解现有类库与其他系统中的源代码。</span><br></pre></td></tr></table></figure></div>

<p>   学习设计模式会让你早点脱离面向对象编程的“菜鸟期”。</p>
<h3 id="1-5-如何学好设计模式"><a href="#1-5-如何学好设计模式" class="headerlink" title="1.5 如何学好设计模式"></a>1.5 如何学好设计模式</h3><p>设计模式的基础是：多态。</p>
<p>初学者：积累案例，不要盲目的背类图。</p>
<p>初级开发人员：多思考，多梳理，归纳总结，尊重事物的认知规律，注意临界点的突破，不要浮躁。</p>
<p>中级开发人员：合适的开发环境，寻找合适的设计模式来解决问题。</p>
<p><strong>多应用，对经典则组合设计模式的大量，自由的运用。要不断的追求。</strong></p>
<h1 id="二、面向对象设计原则"><a href="#二、面向对象设计原则" class="headerlink" title="二、面向对象设计原则"></a>二、面向对象设计原则</h1><p>对于面向对象软件系统的设计而言，在支持可维护性的同时，提高系统的可复用性是一个至关重要的问题，<strong>如何同时提高一个软件系统的可维护性和可复用性是面向对象设计需要解决的核心问题之一。</strong>在面向对象设计中，可维护性的复用是以设计原则为基础的。每一个原则都蕴含一些面向对象设计的思想，可以从不同的角度提升一个软件结构的设计水平。</p>
<p><strong>面向对象设计原则为支持可维护性复用而诞生，这些原则蕴含在很多设计模式中，它们是从许多设计方案中总结出的指导性原则。</strong>面向对象设计原则也是我们用于评价一个设计模式的使用效果的重要指标之一。</p>
<p><strong>原则的目的： 高内聚，低耦合</strong></p>
<h3 id="1-单一职责原则"><a href="#1-单一职责原则" class="headerlink" title="1.单一职责原则"></a>1.单一职责原则</h3><p>类的职责单一，对外只提供一种功能，而引起类变化的原因都应该只有一个。</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ClothesShop <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cs *ClothesShop)</span></span> OnShop() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;休闲的装扮&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ClothesWork <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cw *ClothesWork)</span></span> OnWork() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;工作的装扮&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//工作的时候</span></span><br><span class="line">	cw := <span class="built_in">new</span>(ClothesWork)</span><br><span class="line">	cw.OnWork()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//shopping的时候</span></span><br><span class="line">	cs := <span class="built_in">new</span>(ClothesShop)</span><br><span class="line">	cs.OnShop()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>在面向对象编程的过程中，设计一个类，建议对外提供的功能单一，接口单一，影响一个类的范围就只限定在这一个接口上，一个类的一个接口具备这个类的功能含义，职责单一不复杂。</p>
<h3 id="2-开闭原则设计"><a href="#2-开闭原则设计" class="headerlink" title="2.开闭原则设计"></a>2.开闭原则设计</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656384050269-d28c3daa-007f-4cfb-a3dc-e8235db9ba0d.png"
                      alt="image.png"
                ></p>
<h4 id="2-1-平铺式设计"><a href="#2-1-平铺式设计" class="headerlink" title="2.1 平铺式设计"></a>2.1 平铺式设计</h4><p>那么作为<code>interface</code>数据类型，他存在的意义在哪呢？ 实际上是为了满足一些面向对象的编程思想。我们知道，软件设计的最高目标就是<code>高内聚，低耦合</code>。那么其中有一个设计原则叫<code>开闭原则</code>。什么是开闭原则呢，接下来我们看一个例子：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//我们要写一个类,Banker银行业务员</span></span><br><span class="line"><span class="keyword">type</span> Banker <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//存款业务</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Banker)</span></span> Save() &#123;</span><br><span class="line">	fmt.Println( <span class="string">&quot;进行了 存款业务...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//转账业务</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Banker)</span></span> Transfer() &#123;</span><br><span class="line">	fmt.Println( <span class="string">&quot;进行了 转账业务...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//支付业务</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *Banker)</span></span> Pay() &#123;</span><br><span class="line">	fmt.Println( <span class="string">&quot;进行了 支付业务...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	banker := &amp;Banker&#123;&#125;</span><br><span class="line"></span><br><span class="line">	banker.Save()</span><br><span class="line">	banker.Transfer()</span><br><span class="line">	banker.Pay()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>代码很简单，就是一个银行业务员，他可能拥有很多的业务，比如<code>Save()</code>存款、<code>Transfer()</code>转账、<code>Pay()</code>支付等。那么如果这个业务员模块只有这几个方法还好，但是随着我们的程序写的越来越复杂，银行业务员可能就要增加方法，会导致业务员模块越来越臃肿。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656384346691-7ca800b9-c658-4ca7-855c-f8245f44ac34.png"
                      alt="img"
                ></p>
<p>这样的设计会导致，当我们去给Banker添加新的业务的时候，会直接修改原有的Banker代码，那么Banker模块的功能会越来越多，出现问题的几率也就越来越大，假如此时Banker已经有99个业务了，现在我们要添加第100个业务，可能由于一次的不小心，导致之前99个业务也一起崩溃，因为所有的业务都在一个Banker类里，他们的耦合度太高，Banker的职责也不够单一，代码的维护成本随着业务的复杂正比成倍增大。</p>
<h4 id="2-2-开闭原则设计"><a href="#2-2-开闭原则设计" class="headerlink" title="2.2 开闭原则设计"></a>2.2 开闭原则设计</h4><p>那么，如果我们拥有接口, <code>interface</code>这个东西，那么我们就可以抽象一层出来，制作一个抽象的Banker模块，然后提供一个抽象的方法。 分别根据这个抽象模块，去实现<code>支付Banker（实现支付方法）</code>,<code>转账Banker（实现转账方法）</code><br>如下：<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1651037187759-88836b9c-1da0-490d-b12d-6342401e8bce.png"
                      alt="img"
                ></p>
<p>那么依然可以搞定程序的需求。 然后，当我们想要给Banker添加额外功能的时候，之前我们是直接修改Banker的内容，现在我们可以单独定义一个<code>股票Banker(实现股票方法)</code>，到这个系统中。 而且股票Banker的实现成功或者失败都不会影响之前的稳定系统，他很单一，而且独立。</p>
<p>所以以上，当我们给一个系统添加一个功能的时候，不是通过修改代码，而是通过增添代码来完成，那么就是开闭原则的核心思想了。所以要想满足上面的要求，是一定需要interface来提供一层抽象的接口的。</p>
<p>golang代码实现如下:</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//抽象的银行业务员</span></span><br><span class="line"><span class="keyword">type</span> AbstractBanker <span class="keyword">interface</span>&#123;</span><br><span class="line">	DoBusi()	<span class="comment">//抽象的处理业务接口</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//存款的业务员</span></span><br><span class="line"><span class="keyword">type</span> SaveBanker <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//AbstractBanker</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sb *SaveBanker)</span></span> DoBusi() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;进行了存款&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//转账的业务员</span></span><br><span class="line"><span class="keyword">type</span> TransferBanker <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//AbstractBanker</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tb *TransferBanker)</span></span> DoBusi() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;进行了转账&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//支付的业务员</span></span><br><span class="line"><span class="keyword">type</span> PayBanker <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//AbstractBanker</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(pb *PayBanker)</span></span> DoBusi() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;进行了支付&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//进行存款</span></span><br><span class="line">	sb := &amp;SaveBanker&#123;&#125;</span><br><span class="line">	sb.DoBusi()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//进行转账</span></span><br><span class="line">	tb := &amp;TransferBanker&#123;&#125;</span><br><span class="line">	tb.DoBusi()</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//进行支付</span></span><br><span class="line">	pb := &amp;PayBanker&#123;&#125;</span><br><span class="line">	pb.DoBusi()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>当然我们也可以根据<code>AbstractBanker</code>设计一个小框架</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现架构层(基于抽象层进行业务封装-针对interface接口进行封装)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BankerBusiness</span><span class="params">(banker AbstractBanker)</span></span> &#123;</span><br><span class="line">	<span class="comment">//通过接口来向下调用，(多态现象)</span></span><br><span class="line">	banker.DoBusi()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>那么main中可以如下实现业务调用:</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//进行存款</span></span><br><span class="line">	BankerBusiness(&amp;SaveBanker&#123;&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//进行存款</span></span><br><span class="line">	BankerBusiness(&amp;TransferBanker&#123;&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//进行存款</span></span><br><span class="line">	BankerBusiness(&amp;PayBanker&#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>再看开闭原则定义:<br>开闭原则:一个软件实体如类、模块和函数应该对扩展开放，对修改关闭。<br>简单的说就是在修改需求的时候，应该尽量通过扩展来实现变化，而不是通过修改已有代码来实现变化。</p>
<h4 id="2-3-接口的意义"><a href="#2-3-接口的意义" class="headerlink" title="2.3 接口的意义"></a>2.3 接口的意义</h4><p>好了，现在interface已经基本了解，那么接口的意义最终在哪里呢，想必现在你已经有了一个初步的认知，实际上接口的最大的意义就是实现多态的思想，就是我们可以根据interface类型来设计API接口，那么这种API接口的适应能力不仅能适应当下所实现的全部模块，也适应未来实现的模块来进行调用。 <code>调用未来</code>可能就是接口的最大意义所在吧，这也是为什么架构师那么值钱，因为良好的架构师是可以针对interface设计一套框架，在未来许多年却依然适用。</p>
<h3 id="3-里氏替换原则"><a href="#3-里氏替换原则" class="headerlink" title="3.里氏替换原则"></a>3.里氏替换原则</h3><p>任何基类可以出现的地方，子类一定可以出现。</p>
<p>里氏替换原则是对开闭原则的补充，实现开闭原则的关键步骤就是抽象化，基类与子类的关系就是要尽可能的抽象化。</p>
<h3 id="4-依赖倒置原则"><a href="#4-依赖倒置原则" class="headerlink" title="4.依赖倒置原则"></a>4.依赖倒置原则</h3><p>面向接口编程，抽象不应该依赖于具体类，具体类应当依赖于抽象。</p>
<p>这是为了减少类间的耦合，使系统更适宜于扩展，也更便于维护。</p>
<h3 id="5-最少知道原则（迪米特法则）"><a href="#5-最少知道原则（迪米特法则）" class="headerlink" title="5.最少知道原则（迪米特法则）"></a>5.最少知道原则（迪米特法则）</h3><p>一个实体应当尽量少地与其他实体之间发生相互作用。</p>
<p>还是为了降低耦合，一个类与其他类的关联越少，越易于扩展。</p>
<h3 id="6-接口分离原则"><a href="#6-接口分离原则" class="headerlink" title="6.接口分离原则"></a>6.接口分离原则</h3><p>使用多个专门的接口，而不使用高耦合的单一接口。</p>
<p>避免同一个接口占用过多的职责，更明确的划分，可以降低耦合。高耦合会导致程序不易扩展，提高出错的风险。</p>
<h1 id="三、创建型模式"><a href="#三、创建型模式" class="headerlink" title="三、创建型模式"></a>三、创建型模式</h1><h2 id="3-1简单工厂模式"><a href="#3-1简单工厂模式" class="headerlink" title="3.1简单工厂模式"></a>3.1简单工厂模式</h2><h3 id="3-1-1-为什么需要工厂模式"><a href="#3-1-1-为什么需要工厂模式" class="headerlink" title="3.1.1 为什么需要工厂模式"></a>3.1.1 为什么需要工厂模式</h3><p>首先来看，如果没有工厂模式，在开发者创建一个类的对象时，如果有很多不同种类的对象将会如何实现，代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//水果类</span></span><br><span class="line"><span class="keyword">type</span> Fruit <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *Fruit)</span></span> Show(name <span class="type">string</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> name == <span class="string">&quot;apple&quot;</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;我是苹果&quot;</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> name == <span class="string">&quot;banana&quot;</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;我是香蕉&quot;</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> name == <span class="string">&quot;pear&quot;</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;我是梨&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个Fruit对象</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewFruit</span><span class="params">(name <span class="type">string</span>)</span></span> *Fruit &#123;</span><br><span class="line">	fruit := <span class="built_in">new</span>(Fruit)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> name == <span class="string">&quot;apple&quot;</span> &#123;</span><br><span class="line">		<span class="comment">//创建apple逻辑</span></span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> name == <span class="string">&quot;banana&quot;</span> &#123;</span><br><span class="line">		<span class="comment">//创建banana逻辑</span></span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> name == <span class="string">&quot;pear&quot;</span> &#123;</span><br><span class="line">		<span class="comment">//创建pear逻辑</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	apple := NewFruit(<span class="string">&quot;apple&quot;</span>)</span><br><span class="line">	apple.Show(<span class="string">&quot;apple&quot;</span>)</span><br><span class="line"></span><br><span class="line">	banana := NewFruit(<span class="string">&quot;banana&quot;</span>)</span><br><span class="line">	banana.Show(<span class="string">&quot;banana&quot;</span>)</span><br><span class="line"></span><br><span class="line">	pear := NewFruit(<span class="string">&quot;pear&quot;</span>)</span><br><span class="line">	pear.Show(<span class="string">&quot;pear&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>不难看出，Fruit类是一个“巨大的”类，在该类的设计中存在如下几个问题：</p>
<p>​	(1) 在Fruit类中包含很多“if…else…”代码块，整个类的代码相当冗长，代码越长，阅读难度、维护难度和测试难度也越大；而且大量条件语句的存在还将影响系统的性能，程序在执行过程中需要做大量的条件判断。</p>
<p>​	(2) Fruit类的职责过重，它负责初始化和显示所有的水果对象，将各种水果对象的初始化代码和显示代码集中在一个类中实现，违反了“单一职责原则”，不利于类的重用和维护；   </p>
<p>(3) 当需要增加新类型的水果时，必须修改Fruit类的构造函数NewFruit()和其他相关方法源代码，违反了“开闭原则”。</p>
<p>关键是来观察main()函数，main()函数与Fruit类是两个模块。当业务层希望创建一个对象的时候，将直接依赖Fruit类型的构造方法NewFruit()，这样随着Fruit的越来越复杂，那么业务层的开发逻辑也需要依赖Fruit模块的更新，且随之改变，这样将导致业务层开发需要观察Fruit模块做改动，影响业务层的开发效率和稳定性。整体的依赖关系为。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">业务逻辑层 ---&gt; 基础类模块</span><br></pre></td></tr></table></figure></div>

<p>那么如何将业务层创建对象与基础类模块做解耦呢，这里即可以在中间加一层工厂模块层，来降低业务逻辑层对基础模块层的直接依赖和耦合关联。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">业务逻辑层 ---&gt; 工厂模块 ---&gt; 基础类模块</span><br></pre></td></tr></table></figure></div>

<p>​	这样就引出了需要对工厂模块的一些设计和加工生成基础模块对象的模式。</p>
<h3 id="3-1-2-简单工厂模式角色和职责"><a href="#3-1-2-简单工厂模式角色和职责" class="headerlink" title="3.1.2 简单工厂模式角色和职责"></a>3.1.2 简单工厂模式角色和职责</h3><p>​	简单工厂模式并不属于GoF的23种设计模式。他是开发者自发认为的一种非常简易的设计模式，其角色和职责如下：</p>
<p>​	<strong>工厂（Factory）角色</strong>：简单工厂模式的核心，它负责实现创建所有实例的内部逻辑。工厂类可以被外界直接调用，创建所需的产品对象。</p>
<p>​	<strong>抽象产品（AbstractProduct）角色</strong>：简单工厂模式所创建的所有对象的父类，它负责描述所有实例所共有的公共接口。</p>
<p>​	<strong>具体产品（Concrete Product）角色</strong>：简单工厂模式所创建的具体实例对象。</p>
<p>其标准的设计模式类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656403534138-1ecc2052-e671-46b8-b2f0-b3e987f1a012.jpeg"
                      alt="img"
                ></p>
<h3 id="3-1-3-简单工厂模式实现"><a href="#3-1-3-简单工厂模式实现" class="headerlink" title="3.1.3 简单工厂模式实现"></a>3.1.3 简单工厂模式实现</h3><p>​       根据本章节的案例可以将标准的“简单工厂模式”类图改进如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1659446274113-d1de59e0-4173-4573-91ae-74a9103266f0.jpeg"
                      alt="img"
                ></p>
<p>简单工厂方法模式的实现代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ======= 抽象层 =========</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//水果类(抽象接口)</span></span><br><span class="line"><span class="keyword">type</span> Fruit <span class="keyword">interface</span> &#123;</span><br><span class="line">	Show()	 <span class="comment">//接口的某方法</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ======= 基础类模块 =========</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Apple <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit  <span class="comment">//为了易于理解显示继承(此行可以省略)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(apple *Apple)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是苹果&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Banana <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(banana *Banana)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是香蕉&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Pear <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(pear *Pear)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是梨&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========= 工厂模块  =========</span></span><br><span class="line"><span class="comment">//一个工厂， 有一个生产水果的机器，返回一个抽象水果的指针</span></span><br><span class="line"><span class="keyword">type</span> Factory <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(fac *Factory)</span></span> CreateFruit(kind <span class="type">string</span>) Fruit &#123;</span><br><span class="line">	<span class="keyword">var</span> fruit Fruit</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> kind == <span class="string">&quot;apple&quot;</span> &#123;</span><br><span class="line">		fruit = <span class="built_in">new</span>(Apple)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> kind == <span class="string">&quot;banana&quot;</span> &#123;</span><br><span class="line">		fruit = <span class="built_in">new</span>(Banana)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> kind == <span class="string">&quot;pear&quot;</span> &#123;</span><br><span class="line">		fruit = <span class="built_in">new</span>(Pear)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ==========业务逻辑层==============</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	factory := <span class="built_in">new</span>(Factory)</span><br><span class="line"></span><br><span class="line">	apple := factory.CreateFruit(<span class="string">&quot;apple&quot;</span>)</span><br><span class="line">	apple.Show()</span><br><span class="line"></span><br><span class="line">	banana := factory.CreateFruit(<span class="string">&quot;banana&quot;</span>)</span><br><span class="line">	banana.Show()</span><br><span class="line"></span><br><span class="line">	pear := factory.CreateFruit(<span class="string">&quot;pear&quot;</span>)</span><br><span class="line">	pear.Show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>上述代码可以看出，业务逻辑层只会和工厂模块进行依赖，这样业务逻辑层将不再关心Fruit类是具体怎么创建基础对象的。</p>
<h3 id="3-1-4-简单工厂方法模式的优缺点"><a href="#3-1-4-简单工厂方法模式的优缺点" class="headerlink" title="3.1.4 简单工厂方法模式的优缺点"></a>3.1.4 简单工厂方法模式的优缺点</h3><p>优点：</p>
<ol>
<li><p>实现了对象创建和使用的分离。</p>
</li>
<li><p>不需要记住具体类名，记住参数即可，减少使用者记忆量。</p>
</li>
</ol>
<p>缺点：</p>
<ol>
<li><p>对工厂类职责过重，一旦不能工作，系统受到影响。</p>
</li>
<li><p>增加系统中类的个数，复杂度和理解度增加。</p>
</li>
<li><p>违反“开闭原则”，添加新产品需要修改工厂逻辑，工厂越来越复杂。</p>
</li>
</ol>
<p>适用场景：</p>
<ol>
<li><p>工厂类负责创建的对象比较少，由于创建的对象较少，不会造成工厂方法中的业务逻辑太过复杂。</p>
</li>
<li><p>客户端只知道传入工厂类的参数，对于如何创建对象并不关心。</p>
</li>
</ol>
<h2 id="3-2-工厂方法模式"><a href="#3-2-工厂方法模式" class="headerlink" title="3.2 工厂方法模式"></a>3.2 工厂方法模式</h2><h3 id="3-2-1-工厂方法模式中的角色和职责"><a href="#3-2-1-工厂方法模式中的角色和职责" class="headerlink" title="3.2.1 工厂方法模式中的角色和职责"></a>3.2.1 工厂方法模式中的角色和职责</h3><p><strong>抽象工厂（Abstract Factory）角色</strong>：工厂方法模式的核心，任何工厂类都必须实现这个接口。</p>
<p><strong>工厂（Concrete Factory）角色</strong>：具体工厂类是抽象工厂的一个实现，负责实例化产品对象。</p>
<p><strong>抽象产品（Abstract Product）角色</strong>：工厂方法模式所创建的所有对象的父类，它负责描述所有实例所共有的公共接口。	</p>
<p><strong>具体产品（Concrete Product）角色</strong>：工厂方法模式所创建的具体实例对象。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">简单工厂模式  + “开闭原则” =    工厂方法模式</span><br></pre></td></tr></table></figure></div>

<p>工厂方法模式的标准类图如下：</p>
<p>其标准的设计模式类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656405767817-943d9712-38ca-473a-bbe1-d7393b284879.jpeg"
                      alt="img"
                ></p>
<h3 id="3-2-2-工厂方法模式的实现"><a href="#3-2-2-工厂方法模式的实现" class="headerlink" title="3.2.2 工厂方法模式的实现"></a>3.2.2 工厂方法模式的实现</h3><p>​       根据本章节的案例可以将标准的“工厂方法模式”类图改进如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1660568018354-acf88c4c-b7f2-47c8-9a5a-fb432972e041.jpeg"
                      alt="img"
                ></p>
<p>实现的代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ======= 抽象层 =========</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//水果类(抽象接口)</span></span><br><span class="line"><span class="keyword">type</span> Fruit <span class="keyword">interface</span> &#123;</span><br><span class="line">	Show()	 <span class="comment">//接口的某方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//工厂类(抽象接口)</span></span><br><span class="line"><span class="keyword">type</span> AbstractFactory <span class="keyword">interface</span> &#123;</span><br><span class="line">	CreateFruit() Fruit <span class="comment">//生产水果类(抽象)的生产器方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ======= 基础类模块 =========</span></span><br><span class="line"><span class="keyword">type</span> Apple <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit  <span class="comment">//为了易于理解显示继承(此行可以省略)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(apple *Apple)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是苹果&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Banana <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(banana *Banana)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是香蕉&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Pear <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(pear *Pear)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是梨&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========= 工厂模块  =========</span></span><br><span class="line"><span class="comment">//具体的苹果工厂</span></span><br><span class="line"><span class="keyword">type</span> AppleFactory <span class="keyword">struct</span> &#123;</span><br><span class="line">	AbstractFactory</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(fac *AppleFactory)</span></span> CreateFruit() Fruit &#123;</span><br><span class="line">	<span class="keyword">var</span> fruit Fruit</span><br><span class="line"></span><br><span class="line">	<span class="comment">//生产一个具体的苹果</span></span><br><span class="line">	fruit = <span class="built_in">new</span>(Apple)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的香蕉工厂</span></span><br><span class="line"><span class="keyword">type</span> BananaFactory <span class="keyword">struct</span> &#123;</span><br><span class="line">	AbstractFactory</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(fac *BananaFactory)</span></span> CreateFruit() Fruit &#123;</span><br><span class="line">	<span class="keyword">var</span> fruit Fruit</span><br><span class="line"></span><br><span class="line">	<span class="comment">//生产一个具体的香蕉</span></span><br><span class="line">	fruit = <span class="built_in">new</span>(Banana)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的梨工厂</span></span><br><span class="line"><span class="keyword">type</span> PearFactory <span class="keyword">struct</span> &#123;</span><br><span class="line">	AbstractFactory</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(fac *PearFactory)</span></span> CreateFruit() Fruit &#123;</span><br><span class="line">	<span class="keyword">var</span> fruit Fruit</span><br><span class="line"></span><br><span class="line">	<span class="comment">//生产一个具体的梨</span></span><br><span class="line">	fruit = <span class="built_in">new</span>(Pear)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//======= 业务逻辑层 =======</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		本案例为了突出根据依赖倒转原则与面向接口编程特性。</span></span><br><span class="line"><span class="comment">	    一些变量的定义将使用显示类型声明方式</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//需求1：需要一个具体的苹果对象</span></span><br><span class="line">	<span class="comment">//1-先要一个具体的苹果工厂</span></span><br><span class="line">	<span class="keyword">var</span> appleFac AbstractFactory</span><br><span class="line">	appleFac = <span class="built_in">new</span>(AppleFactory)</span><br><span class="line">	<span class="comment">//2-生产相对应的具体水果</span></span><br><span class="line">	<span class="keyword">var</span> apple Fruit</span><br><span class="line">	apple = appleFac.CreateFruit()</span><br><span class="line"></span><br><span class="line">	apple.Show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//需求2：需要一个具体的香蕉对象</span></span><br><span class="line">	<span class="comment">//1-先要一个具体的香蕉工厂</span></span><br><span class="line">	<span class="keyword">var</span> bananaFac AbstractFactory</span><br><span class="line">	bananaFac = <span class="built_in">new</span>(BananaFactory)</span><br><span class="line">	<span class="comment">//2-生产相对应的具体水果</span></span><br><span class="line">	<span class="keyword">var</span> banana Fruit</span><br><span class="line">	banana = bananaFac.CreateFruit()</span><br><span class="line"></span><br><span class="line">	banana.Show()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//需求3：需要一个具体的梨对象</span></span><br><span class="line">	<span class="comment">//1-先要一个具体的梨工厂</span></span><br><span class="line">	<span class="keyword">var</span> pearFac AbstractFactory</span><br><span class="line">	pearFac = <span class="built_in">new</span>(PearFactory)</span><br><span class="line">	<span class="comment">//2-生产相对应的具体水果</span></span><br><span class="line">	<span class="keyword">var</span> pear Fruit</span><br><span class="line">	pear = pearFac.CreateFruit()</span><br><span class="line"></span><br><span class="line">	pear.Show()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//需求4：需要一个日本的苹果？</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>上述代码是通过面向抽象层开发，业务逻辑层的main()函数逻辑，依然是只与工厂耦合，且只与抽象的工厂和抽象的水果类耦合，这样就遵循了面向抽象层接口编程的原则。</p>
<p>那么抽象的工厂方法模式如何体现“开闭原则”的。接下来可以尝试在原有的代码上添加一种新产品的生产，如“日本苹果”，具体的代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ======= 抽象层 =========</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//水果类(抽象接口)</span></span><br><span class="line"><span class="keyword">type</span> Fruit <span class="keyword">interface</span> &#123;</span><br><span class="line">	Show()	 <span class="comment">//接口的某方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//工厂类(抽象接口)</span></span><br><span class="line"><span class="keyword">type</span> AbstractFactory <span class="keyword">interface</span> &#123;</span><br><span class="line">	CreateFruit() Fruit <span class="comment">//生产水果类(抽象)的生产器方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ======= 基础类模块 =========</span></span><br><span class="line"><span class="keyword">type</span> Apple <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit  <span class="comment">//为了易于理解显示继承(此行可以省略)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(apple *Apple)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是苹果&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Banana <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(banana *Banana)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是香蕉&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Pear <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(pear *Pear)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是梨&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//(+) 新增一个&quot;日本苹果&quot;</span></span><br><span class="line"><span class="keyword">type</span> JapanApple <span class="keyword">struct</span> &#123;</span><br><span class="line">	Fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(jp *JapanApple)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;我是日本苹果&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========= 工厂模块  =========</span></span><br><span class="line"><span class="comment">//具体的苹果工厂</span></span><br><span class="line"><span class="keyword">type</span> AppleFactory <span class="keyword">struct</span> &#123;</span><br><span class="line">	AbstractFactory</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(fac *AppleFactory)</span></span> CreateFruit() Fruit &#123;</span><br><span class="line">	<span class="keyword">var</span> fruit Fruit</span><br><span class="line"></span><br><span class="line">	<span class="comment">//生产一个具体的苹果</span></span><br><span class="line">	fruit = <span class="built_in">new</span>(Apple)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的香蕉工厂</span></span><br><span class="line"><span class="keyword">type</span> BananaFactory <span class="keyword">struct</span> &#123;</span><br><span class="line">	AbstractFactory</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(fac *BananaFactory)</span></span> CreateFruit() Fruit &#123;</span><br><span class="line">	<span class="keyword">var</span> fruit Fruit</span><br><span class="line"></span><br><span class="line">	<span class="comment">//生产一个具体的香蕉</span></span><br><span class="line">	fruit = <span class="built_in">new</span>(Banana)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的梨工厂</span></span><br><span class="line"><span class="keyword">type</span> PearFactory <span class="keyword">struct</span> &#123;</span><br><span class="line">	AbstractFactory</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(fac *PearFactory)</span></span> CreateFruit() Fruit &#123;</span><br><span class="line">	<span class="keyword">var</span> fruit Fruit</span><br><span class="line"></span><br><span class="line">	<span class="comment">//生产一个具体的梨</span></span><br><span class="line">	fruit = <span class="built_in">new</span>(Pear)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的日本工厂</span></span><br><span class="line"><span class="keyword">type</span> JapanAppleFactory <span class="keyword">struct</span> &#123;</span><br><span class="line">	AbstractFactory</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(fac *JapanAppleFactory)</span></span> CreateFruit() Fruit &#123;</span><br><span class="line">	<span class="keyword">var</span> fruit Fruit</span><br><span class="line"></span><br><span class="line">	<span class="comment">//生产一个具体的日本苹果</span></span><br><span class="line">	fruit = <span class="built_in">new</span>(JapanApple)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> fruit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ========= 业务逻辑层  =========</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		本案例为了突出根据依赖倒转原则与面向接口编程特性。</span></span><br><span class="line"><span class="comment">	    一些变量的定义将使用显示类型声明方式</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//需求1：需要一个具体的苹果对象</span></span><br><span class="line">	<span class="comment">//1-先要一个具体的苹果工厂</span></span><br><span class="line">	<span class="keyword">var</span> appleFac AbstractFactory</span><br><span class="line">	appleFac = <span class="built_in">new</span>(AppleFactory)</span><br><span class="line">	<span class="comment">//2-生产相对应的具体水果</span></span><br><span class="line">	<span class="keyword">var</span> apple Fruit</span><br><span class="line">	apple = appleFac.CreateFruit()</span><br><span class="line"></span><br><span class="line">	apple.Show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//需求2：需要一个具体的香蕉对象</span></span><br><span class="line">	<span class="comment">//1-先要一个具体的香蕉工厂</span></span><br><span class="line">	<span class="keyword">var</span> bananaFac AbstractFactory</span><br><span class="line">	bananaFac = <span class="built_in">new</span>(BananaFactory)</span><br><span class="line">	<span class="comment">//2-生产相对应的具体水果</span></span><br><span class="line">	<span class="keyword">var</span> banana Fruit</span><br><span class="line">	banana = bananaFac.CreateFruit()</span><br><span class="line"></span><br><span class="line">	banana.Show()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//需求3：需要一个具体的梨对象</span></span><br><span class="line">	<span class="comment">//1-先要一个具体的梨工厂</span></span><br><span class="line">	<span class="keyword">var</span> pearFac AbstractFactory</span><br><span class="line">	pearFac = <span class="built_in">new</span>(PearFactory)</span><br><span class="line">	<span class="comment">//2-生产相对应的具体水果</span></span><br><span class="line">	<span class="keyword">var</span> pear Fruit</span><br><span class="line">	pear = pearFac.CreateFruit()</span><br><span class="line"></span><br><span class="line">	pear.Show()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//需求4：需要一个日本的苹果？</span></span><br><span class="line">	<span class="comment">//1-先要一个具体的日本评估工厂</span></span><br><span class="line">	<span class="keyword">var</span> japanAppleFac AbstractFactory</span><br><span class="line">	japanAppleFac = <span class="built_in">new</span>(JapanAppleFactory)</span><br><span class="line">	<span class="comment">//2-生产相对应的具体水果</span></span><br><span class="line">	<span class="keyword">var</span> japanApple Fruit</span><br><span class="line">	japanApple = japanAppleFac.CreateFruit()</span><br><span class="line"></span><br><span class="line">	japanApple.Show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>可以看见，新增的基本类“日本苹果”，和“具体的工厂” 均没有改动之前的任何代码。完全符合开闭原则思想。新增的功能不会影响到之前的已有的系统稳定性。</p>
<h3 id="3-2-3-工厂方法模式的优缺点"><a href="#3-2-3-工厂方法模式的优缺点" class="headerlink" title="3.2.3 工厂方法模式的优缺点"></a>3.2.3 工厂方法模式的优缺点</h3><p>优点：</p>
<ul>
<li>不需要记住具体类名，甚至连具体参数都不用记忆。</li>
<li>实现了对象创建和使用的分离。</li>
<li>系统的可扩展性也就变得非常好，无需修改接口和原类。</li>
<li>对于新产品的创建，符合开闭原则。</li>
</ul>
<p>缺点：</p>
<ul>
<li>增加系统中类的个数，复杂度和理解度增加。</li>
<li>增加了系统的抽象性和理解难度。</li>
</ul>
<p>适用场景：</p>
<ul>
<li>客户端不知道它所需要的对象的类。</li>
<li>抽象工厂类通过其子类来指定创建哪个对象。</li>
</ul>
<h2 id="3-3抽象工厂方法"><a href="#3-3抽象工厂方法" class="headerlink" title="3.3抽象工厂方法"></a>3.3抽象工厂方法</h2><p>工厂方法模式通过引入工厂等级结构，解决了简单工厂模式中工厂类职责太重的问题，但由于工厂方法模式中的每个工厂只生产一类产品，可能会导致系统中存在大量的工厂类，势必会增加系统的开销。因此，可以考虑将一些相关的产品组成一个“产品族”，由同一个工厂来统一生产，这就是本文将要学习的抽象工厂模式的基本思想。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656412472323-70134cf9-d201-473c-b228-8d5b2b834453.jpeg"
                      alt="img"
                ></p>
<p>从工厂方法模式可以看出来：</p>
<p>（1）当添加一个新产品的时候，比如葡萄，虽然不用修改代码，但是需要添加大量的类，而且还需要添加相对的工厂。（系统开销，维护成本）</p>
<p>（2）如果使用同一地域的水果（日本苹果，日本香蕉，日本梨），那么需要分别创建具体的工厂，如果选择出现失误，将会造成混乱，虽然可以加一些约束，但是代码实现变得复杂。</p>
<p>所以“抽象工厂方法模式”引出了“产品族”和“产品等级结构”概念，其目的是为了更加高效的生产同一个产品组产品。</p>
<h3 id="3-3-1-产品族与产品等级结构"><a href="#3-3-1-产品族与产品等级结构" class="headerlink" title="3.3.1 产品族与产品等级结构"></a>3.3.1 产品族与产品等级结构</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656415902459-7f26af5c-97c6-458b-b1cd-eb4efb23403e.jpeg"
                      alt="img"
                ></p>
<p>上图表示“产品族”和“产品登记结构”的关系。</p>
<p>产品族：具有同一个地区、同一个厂商、同一个开发包、同一个组织模块等，但是具备不同特点或功能的产品集合，称之为是一个产品族。</p>
<p>产品等级结构：具有相同特点或功能，但是来自不同的地区、不同的厂商、不同的开发包、不同的组织模块等的产品集合，称之为是一个产品等级结构。</p>
<p>当程序中的对象可以被划分为产品族和产品等级结构之后，那么“抽象工厂方法模式”才可以被适用。</p>
<p>“抽象工厂方法模式”是针对“产品族”进行生产产品，具体如下图所示。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656415990421-fa8826ec-2128-4548-84d1-21292bf8a953.jpeg"
                      alt="img"
                ></p>
<h3 id="3-3-2-抽象工厂模式的角色和职责"><a href="#3-3-2-抽象工厂模式的角色和职责" class="headerlink" title="3.3.2 抽象工厂模式的角色和职责"></a>3.3.2 抽象工厂模式的角色和职责</h3><p>抽象工厂（Abstract Factory）角色：它声明了一组用于创建一族产品的方法，每一个方法对应一种产品。</p>
<p>具体工厂（Concrete Factory）角色：它实现了在抽象工厂中声明的创建产品的方法，生成一组具体产品，这些产品构成了一个产品族，每一个产品都位于某个产品等级结构中。</p>
<p>抽象产品（Abstract Product）角色：它为每种产品声明接口，在抽象产品中声明了产品所具有的业务方法。</p>
<p>具体产品（Concrete Product）角色：它定义具体工厂生产的具体产品对象，实现抽象产品接口中声明的业务方法。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656499122737-301b32c4-00ef-41cd-850b-a567380f5030.jpeg"
                      alt="img"
                ></p>
<p>可以看出来具体的工厂1，只负责生成具体的产品A1和B1，具体的工厂2，只负责生成具体的产品A2和B2。</p>
<p>“工厂1、A1、B1”为一组，是一个产品族， “工厂2、A2、B2”为一组，也是一个产品族。</p>
<h3 id="3-3-3-抽象工厂方法模式的实现"><a href="#3-3-3-抽象工厂方法模式的实现" class="headerlink" title="3.3.3 抽象工厂方法模式的实现"></a>3.3.3 抽象工厂方法模式的实现</h3><p>抽象工厂方法模式按照本章节的案例，可以得到类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1660569278988-01b0161f-6f52-4a13-8437-e9db65657247.jpeg"
                      alt="img"
                ></p>
<p>代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ======= 抽象层 =========</span></span><br><span class="line"><span class="keyword">type</span> AbstractApple <span class="keyword">interface</span> &#123;</span><br><span class="line">	ShowApple()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AbstractBanana <span class="keyword">interface</span> &#123;</span><br><span class="line">	ShowBanana()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AbstractPear <span class="keyword">interface</span> &#123;</span><br><span class="line">	ShowPear()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//抽象工厂</span></span><br><span class="line"><span class="keyword">type</span> AbstractFactory <span class="keyword">interface</span> &#123;</span><br><span class="line">	CreateApple() AbstractApple</span><br><span class="line">	CreateBanana() AbstractBanana</span><br><span class="line">	CreatePear() AbstractPear</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ======== 实现层 =========</span></span><br><span class="line"><span class="comment">/*  中国产品族 */</span></span><br><span class="line"><span class="keyword">type</span> ChinaApple <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ca *ChinaApple)</span></span> ShowApple() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;中国苹果&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ChinaBanana <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cb *ChinaBanana)</span></span> ShowBanana() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;中国香蕉&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ChinaPear <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cp *ChinaPear)</span></span> ShowPear() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;中国梨&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ChinaFactory <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cf *ChinaFactory)</span></span> CreateApple() AbstractApple &#123;</span><br><span class="line">	<span class="keyword">var</span> apple AbstractApple</span><br><span class="line"></span><br><span class="line">	apple = <span class="built_in">new</span>(ChinaApple)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> apple</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cf *ChinaFactory)</span></span> CreateBanana() AbstractBanana &#123;</span><br><span class="line">	<span class="keyword">var</span> banana AbstractBanana</span><br><span class="line"></span><br><span class="line">	banana = <span class="built_in">new</span>(ChinaBanana)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> banana</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cf *ChinaFactory)</span></span> CreatePear() AbstractPear &#123;</span><br><span class="line">	<span class="keyword">var</span> pear AbstractPear</span><br><span class="line"></span><br><span class="line">	pear = <span class="built_in">new</span>(ChinaPear)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> pear</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  日本产品族 */</span></span><br><span class="line"><span class="keyword">type</span> JapanApple <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ja *JapanApple)</span></span> ShowApple() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;日本苹果&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> JapanBanana <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(jb *JapanBanana)</span></span> ShowBanana() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;日本香蕉&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> JapanPear <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cp *JapanPear)</span></span> ShowPear() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;日本梨&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> JapanFactory <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(jf *JapanFactory)</span></span> CreateApple() AbstractApple &#123;</span><br><span class="line">	<span class="keyword">var</span> apple AbstractApple</span><br><span class="line"></span><br><span class="line">	apple = <span class="built_in">new</span>(JapanApple)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> apple</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(jf *JapanFactory)</span></span> CreateBanana() AbstractBanana &#123;</span><br><span class="line">	<span class="keyword">var</span> banana AbstractBanana</span><br><span class="line"></span><br><span class="line">	banana = <span class="built_in">new</span>(JapanBanana)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> banana</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(cf *JapanFactory)</span></span> CreatePear() AbstractPear &#123;</span><br><span class="line">	<span class="keyword">var</span> pear AbstractPear</span><br><span class="line"></span><br><span class="line">	pear = <span class="built_in">new</span>(JapanPear)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> pear</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  美国产品族 */</span></span><br><span class="line"><span class="keyword">type</span> AmericanApple <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(aa *AmericanApple)</span></span> ShowApple() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;美国苹果&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AmericanBanana <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ab *AmericanBanana)</span></span> ShowBanana() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;美国香蕉&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AmericanPear <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ap *AmericanPear)</span></span> ShowPear() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;美国梨&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AmericanFactory <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(af *AmericanFactory)</span></span> CreateApple() AbstractApple &#123;</span><br><span class="line">	<span class="keyword">var</span> apple AbstractApple</span><br><span class="line"></span><br><span class="line">	apple = <span class="built_in">new</span>(AmericanApple)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> apple</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(af *AmericanFactory)</span></span> CreateBanana() AbstractBanana &#123;</span><br><span class="line">	<span class="keyword">var</span> banana AbstractBanana</span><br><span class="line"></span><br><span class="line">	banana = <span class="built_in">new</span>(AmericanBanana)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> banana</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(af *AmericanFactory)</span></span> CreatePear() AbstractPear &#123;</span><br><span class="line">	<span class="keyword">var</span> pear AbstractPear</span><br><span class="line"></span><br><span class="line">	pear = <span class="built_in">new</span>(AmericanPear)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> pear</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ======== 业务逻辑层 =======</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//需求1: 需要美国的苹果、香蕉、梨 等对象</span></span><br><span class="line">	<span class="comment">//1-创建一个美国工厂</span></span><br><span class="line">	<span class="keyword">var</span> aFac AbstractFactory</span><br><span class="line">	aFac = <span class="built_in">new</span>(AmericanFactory)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2-生产美国苹果</span></span><br><span class="line">	<span class="keyword">var</span> aApple AbstractApple</span><br><span class="line">	aApple = aFac.CreateApple()</span><br><span class="line">	aApple.ShowApple()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//3-生产美国香蕉</span></span><br><span class="line">	<span class="keyword">var</span> aBanana AbstractBanana</span><br><span class="line">	aBanana = aFac.CreateBanana()</span><br><span class="line">	aBanana.ShowBanana()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//4-生产美国梨</span></span><br><span class="line">	<span class="keyword">var</span> aPear AbstractPear</span><br><span class="line">	aPear = aFac.CreatePear()</span><br><span class="line">	aPear.ShowPear()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//需求2: 需要中国的苹果、香蕉</span></span><br><span class="line">	<span class="comment">//1-创建一个中国工厂</span></span><br><span class="line">	cFac := <span class="built_in">new</span>(ChinaFactory)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2-生产中国苹果</span></span><br><span class="line">	cApple := cFac.CreateApple()</span><br><span class="line">	cApple.ShowApple()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//3-生产中国香蕉</span></span><br><span class="line">	cBanana := cFac.CreateBanana()</span><br><span class="line">	cBanana.ShowBanana()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<p>思考：抽象工厂模式是否符合“开闭原则”？</p>
<h3 id="3-3-4-抽象工厂模式的优缺点"><a href="#3-3-4-抽象工厂模式的优缺点" class="headerlink" title="3.3.4 抽象工厂模式的优缺点"></a>3.3.4 抽象工厂模式的优缺点</h3><p>优点：</p>
<ol>
<li><p>拥有工厂方法模式的优点</p>
</li>
<li><p>当一个产品族中的多个对象被设计成一起工作时，它能够保证客户端始终只使用同一个产品族中的对象。</p>
</li>
<li><p>增加新的产品族很方便，无须修改已有系统，符合“开闭原则”。</p>
</li>
</ol>
<p>缺点：</p>
<ol>
<li>增加新的产品等级结构麻烦，需要对原有系统进行较大的修改，甚至需要修改抽象层代码，这显然会带来较大的不便，违背了“开闭原则”。</li>
</ol>
<h3 id="3-3-5-适用场景"><a href="#3-3-5-适用场景" class="headerlink" title="3.3.5 适用场景"></a>3.3.5 适用场景</h3><p>(1) 系统中有多于一个的产品族。而每次只使用其中某一产品族。可以通过配置文件等方式来使得用户可以动态改变产品族，也可以很方便地增加新的产品族。</p>
<p>(2) 产品等级结构稳定。设计完成之后，不会向系统中增加新的产品等级结构或者删除已有的产品等级结构。</p>
<h2 id="3-4单例模式"><a href="#3-4单例模式" class="headerlink" title="3.4单例模式"></a>3.4单例模式</h2><p>保证一个类、只有一个实例存在，同时提供能对该实例加以访问的全局访问方法。</p>
<p>是GoF给出单例模式的定义。</p>
<h3 id="3-4-1-单例模式中的角色和职责"><a href="#3-4-1-单例模式中的角色和职责" class="headerlink" title="3.4.1 单例模式中的角色和职责"></a>3.4.1 单例模式中的角色和职责</h3><p>单例模式的标准类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656571484968-7f76261e-b135-4ad5-a1d0-4607ea2d316f.jpeg"
                      alt="img"
                ></p>
<p><strong>Singleton（单例）</strong>：在单例类的内部实现只生成一个实例，同时它提供一个静态的getInstance()工厂方法，让客户可以访问它的唯一实例；为了防止在外部对其实例化，将其构造函数设计为私有；在单例类内部定义了一个Singleton类型的静态对象，作为外部共享的唯一实例。</p>
<p>单例模式要解决的问题是：</p>
<p>保证一个类永远只能有一个对象，且该对象的功能依然能被其他模块使用。</p>
<h3 id="3-4-2-单例模式逻辑推演实现"><a href="#3-4-2-单例模式逻辑推演实现" class="headerlink" title="3.4.2 单例模式逻辑推演实现"></a>3.4.2 单例模式逻辑推演实现</h3><div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">三个要点：</span></span><br><span class="line"><span class="comment">		一是某个类只能有一个实例；</span></span><br><span class="line"><span class="comment">		二是它必须自行创建这个实例；</span></span><br><span class="line"><span class="comment">		三是它必须自行向整个系统提供这个实例。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	保证一个类永远只能有一个对象</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//1、保证这个类非公有化，外界不能通过这个类直接创建一个对象</span></span><br><span class="line"><span class="comment">//   那么这个类就应该变得非公有访问 类名称首字母要小写</span></span><br><span class="line"><span class="keyword">type</span> singelton <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2、但是还要有一个指针可以指向这个唯一对象，但是这个指针永远不能改变方向</span></span><br><span class="line"><span class="comment">//   Golang中没有常指针概念，所以只能通过将这个指针私有化不让外部模块访问</span></span><br><span class="line"><span class="keyword">var</span> instance *singelton = <span class="built_in">new</span>(singelton)</span><br><span class="line"></span><br><span class="line"><span class="comment">//3、如果全部为私有化，那么外部模块将永远无法访问到这个类和对象，</span></span><br><span class="line"><span class="comment">//   所以需要对外提供一个方法来获取这个唯一实例对象</span></span><br><span class="line"><span class="comment">//   注意：这个方法是否可以定义为singelton的一个成员方法呢？</span></span><br><span class="line"><span class="comment">//       答案是不能，因为如果为成员方法就必须要先访问对象、再访问函数</span></span><br><span class="line"><span class="comment">//        但是类和对象目前都已经私有化，外界无法访问，所以这个方法一定是一个全局普通函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetInstance</span><span class="params">()</span></span> *singelton &#123;</span><br><span class="line">	<span class="keyword">return</span> instance</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *singelton)</span></span> SomeThing() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;单例对象的某方法&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	s := GetInstance()</span><br><span class="line">	s.SomeThing()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>上面代码推演了一个单例的创建和逻辑过程，上述是单例模式中的一种，属于“饿汉式”。含义是，在初始化单例唯一指针的时候，就已经提前开辟好了一个对象，申请了内存。饿汉式的好处是，不会出现线程并发创建，导致多个单例的出现，但是缺点是如果这个单例对象在业务逻辑没有被使用，也会客观的创建一块内存对象。那么与之对应的模式叫“懒汉式”，代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> singelton <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance *singelton</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetInstance</span><span class="params">()</span></span> *singelton &#123;</span><br><span class="line">	<span class="comment">//只有首次GetInstance()方法被调用，才会生成这个单例的实例</span></span><br><span class="line">	<span class="keyword">if</span> instance == <span class="literal">nil</span> &#123;</span><br><span class="line">		instance = <span class="built_in">new</span>(singelton)</span><br><span class="line">		<span class="keyword">return</span> instance</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//接下来的GetInstance直接返回已经申请的实例即可</span></span><br><span class="line">	<span class="keyword">return</span> instance</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *singelton)</span></span> SomeThing() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;单例对象的某方法&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	s := GetInstance()</span><br><span class="line">	s.SomeThing()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h3 id="3-4-3-线程安全的单例模式实现"><a href="#3-4-3-线程安全的单例模式实现" class="headerlink" title="3.4.3 线程安全的单例模式实现"></a>3.4.3 线程安全的单例模式实现</h3><p>上面的“懒汉式”实现是非线程安全的设计方式，也就是如果多个线程或者协程同时首次调用GetInstance()方法有概率导致多个实例被创建，则违背了单例的设计初衷。那么在上面的基础上进行修改，可以利用Sync.Mutex进行加锁，保证线程安全。这种线程安全的写法，有个最大的缺点就是每次调用该方法时都需要进行锁操作，在性能上相对不高效，具体的实现改进如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义锁</span></span><br><span class="line"><span class="keyword">var</span> lock sync.Mutex</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> singelton <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance *singelton</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetInstance</span><span class="params">()</span></span> *singelton &#123;</span><br><span class="line">	<span class="comment">//为了线程安全，增加互斥</span></span><br><span class="line">	lock.Lock()</span><br><span class="line">	<span class="keyword">defer</span> lock.Unlock()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> instance == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">new</span>(singelton)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> instance</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *singelton)</span></span> SomeThing() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;单例对象的某方法&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	s := GetInstance()</span><br><span class="line">	s.SomeThing()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>上面代码虽然解决了线程安全，但是每次调用GetInstance()都要加锁会极大影响性能。所以接下来可以借助”sync&#x2F;atomic”来进行内存的状态存留来做互斥。atomic就可以自动加载和设置标记，代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">	<span class="string">&quot;sync/atomic&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//标记</span></span><br><span class="line"><span class="keyword">var</span> initialized <span class="type">uint32</span></span><br><span class="line"><span class="keyword">var</span> lock sync.Mutex</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> singelton <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance *singelton</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetInstance</span><span class="params">()</span></span> *singelton &#123;</span><br><span class="line">	<span class="comment">//如果标记为被设置，直接返回，不加锁</span></span><br><span class="line">	<span class="keyword">if</span> atomic.LoadUint32(&amp;initialized) == <span class="number">1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> instance</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果没有，则加锁申请</span></span><br><span class="line">	lock.Lock()</span><br><span class="line">	<span class="keyword">defer</span> lock.Unlock()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> initialized == <span class="number">0</span> &#123;</span><br><span class="line">		instance = <span class="built_in">new</span>(singelton)</span><br><span class="line">		<span class="comment">//设置标记位</span></span><br><span class="line">		atomic.StoreUint32(&amp;initialized, <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> instance</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *singelton)</span></span> SomeThing() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;单例对象的某方法&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	s := GetInstance()</span><br><span class="line">	s.SomeThing()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>上述的实现其实Golang有个方法已经帮助开发者实现完成，就是Once模块，来看下Once.Do()方法的源代码：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(o *Once)</span></span> Do(f <span class="function"><span class="keyword">func</span><span class="params">()</span></span>) &#123;　　　<span class="comment">//判断是否执行过该方法，如果执行过则不执行</span></span><br><span class="line">    <span class="keyword">if</span> atomic.LoadUint32(&amp;o.done) == <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Slow-path.</span></span><br><span class="line">    o.m.Lock()</span><br><span class="line">    <span class="keyword">defer</span> o.m.Unlock()　　</span><br><span class="line">    <span class="keyword">if</span> o.done == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">defer</span> atomic.StoreUint32(&amp;o.done, <span class="number">1</span>)</span><br><span class="line">        f()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>所以完全可以借助Once来实现单例模式的实现，优化的代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> once sync.Once</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> singelton <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance *singelton</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetInstance</span><span class="params">()</span></span> *singelton &#123;</span><br><span class="line"></span><br><span class="line">	once.Do(<span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">		instance = <span class="built_in">new</span>(singelton)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> instance</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *singelton)</span></span> SomeThing() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;单例对象的某方法&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	s := GetInstance()</span><br><span class="line">	s.SomeThing()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h3 id="3-4-4-单例模式的优缺点"><a href="#3-4-4-单例模式的优缺点" class="headerlink" title="3.4.4 单例模式的优缺点"></a>3.4.4 单例模式的优缺点</h3><p>优点：</p>
<p>(1) 单例模式提供了对唯一实例的受控访问。</p>
<p>(2) 节约系统资源。由于在系统内存中只存在一个对象。    </p>
<p>缺点：</p>
<p>(1) 扩展略难。单例模式中没有抽象层。</p>
<p>(2) 单例类的职责过重。   </p>
<h3 id="3-4-5-适用场景"><a href="#3-4-5-适用场景" class="headerlink" title="3.4.5 适用场景"></a>3.4.5 适用场景</h3><p>(1) 系统只需要一个实例对象，如系统要求提供一个唯一的序列号生成器或资源管理器，或者需要考虑资源消耗太大而只允许创建一个对象。</p>
<p>(2) 客户调用类的单个实例只允许使用一个公共访问点，除了该公共访问点，不能通过其他途径访问该实例。</p>
<h1 id="四、结构型模式"><a href="#四、结构型模式" class="headerlink" title="四、结构型模式"></a>四、结构型模式</h1><h2 id="4-1代理模式"><a href="#4-1代理模式" class="headerlink" title="4.1代理模式"></a>4.1代理模式</h2><p>Proxy模式又叫做代理模式，是构造型的设计模式之一，它可以为其他对象提供一种代理（Proxy）以控制对这个对象的访问。	</p>
<p>​	所谓代理，是指具有与代理元（被代理的对象）具有相同的接口的类，客户端必须通过代理与被代理的目标类交互，而代理一般在交互的过程中（交互前后），进行某些特别的处理。</p>
<p>用一个日常可见的案例来理解“代理”的概念，如下图：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656652705131-ed02827b-537d-416f-ae92-e3b2556b165e.png"
                      alt="img"
                ></p>
<p>这里假设有一个“自己”的角色，正在玩一款网络游戏。称这个网络游戏就是代理模式的“Subject”，表示要做一件事的目标或者对象事件主题。</p>
<p>（1）“自己”有一个给游戏角色升级的需求或者任务，当然“自己”可以独自完成游戏任务的升级。</p>
<p>（2）或者“自己”也可以邀请以为更加擅长游戏的“游戏代练”来完成升级这件事，这个代练就是“Proxy”代理。</p>
<p>（3）“游戏代练”不仅能够完成升级的任务需求，还可以额外做一些附加的能力。比如打到一些好的游戏装备、加入公会等等周边收益。</p>
<p>所以代理的出现实则是为了能够覆盖“自己”的原本的需求，且可以额外做其他功能，这种额外创建的类是不影响已有的“自己”和“网络游戏”的的关系。是额外添加，在设计模式原则上，是符合“开闭原则”思想。那么当需要给“自己”增加额外功能的时候，又不想改变自己，那么就选择邀请一位”代理”来完成吧。</p>
<h3 id="4-1-1-代理模式中的角色和职责"><a href="#4-1-1-代理模式中的角色和职责" class="headerlink" title="4.1.1 代理模式中的角色和职责"></a>4.1.1 代理模式中的角色和职责</h3><p>代理模式的标准类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656653669744-bd8954b1-8bf5-4839-9c78-d1dbc032e2a3.jpeg"
                      alt="img"
                ></p>
<p><strong>subject（抽象主题角色）</strong>：真实主题与代理主题的共同接口。</p>
<p>​	<strong>RealSubject（真实主题角色）</strong>：定义了代理角色所代表的真实对象。 </p>
<p>​	<strong>Proxy（代理主题角色）：</strong>含有对真实主题角色的引用，代理角色通常在将客户端调用传递给真是主题对象之前或者之后执行某些操作，而不是单纯返回真实的对象。</p>
<h3 id="4-1-2-代理模式案例实现"><a href="#4-1-2-代理模式案例实现" class="headerlink" title="4.1.2 代理模式案例实现"></a>4.1.2 代理模式案例实现</h3><p>讲述标准类图改成一个案例来理解。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656654208318-768b4620-a1f8-4396-b9c6-94990b826297.jpeg"
                      alt="img"
                ></p>
<p>这里以一个购物作为一个主题任务，这是一个抽象的任务。具体的购物主题分别包括“韩国购物”、“美国购物”、“非洲购物”等。可以这些都是“自己”去完成主题，那么如果希望不仅完成购物，还要做真假辨别、海关安检等，同样依然能够完成自己本身的具体购物主题，那么则可以创建一个新的代理来完成这件事。代理需要将被代理的主题关联到本类中，去重新实现Buy()方法，在Buy()方法中，调用被调用的Buy()，在额外完成辨别真伪和海关安检两个任务动作，具体的代码实现如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Goods <span class="keyword">struct</span> &#123;</span><br><span class="line">	Kind <span class="type">string</span>   <span class="comment">//商品种类</span></span><br><span class="line">	Fact <span class="type">bool</span>	  <span class="comment">//商品真伪</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// =========== 抽象层 ===========</span></span><br><span class="line"><span class="comment">//抽象的购物主题Subject</span></span><br><span class="line"><span class="keyword">type</span> Shopping <span class="keyword">interface</span> &#123;</span><br><span class="line">	Buy(goods *Goods) <span class="comment">//某任务</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// =========== 实现层 ===========</span></span><br><span class="line"><span class="comment">//具体的购物主题， 实现了shopping， 去韩国购物</span></span><br><span class="line"><span class="keyword">type</span> KoreaShopping <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ks *KoreaShopping)</span></span> Buy(goods *Goods) &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;去韩国进行了购物, 买了 &quot;</span>, goods.Kind)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的购物主题， 实现了shopping， 去美国购物</span></span><br><span class="line"><span class="keyword">type</span> AmericanShopping <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(as *AmericanShopping)</span></span> Buy(goods *Goods) &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;去美国进行了购物, 买了 &quot;</span>, goods.Kind)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的购物主题， 实现了shopping， 去非洲购物</span></span><br><span class="line"><span class="keyword">type</span> AfrikaShopping <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(as *AfrikaShopping)</span></span> Buy(goods *Goods) &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;去非洲进行了购物, 买了 &quot;</span>, goods.Kind)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//海外的代理</span></span><br><span class="line"><span class="keyword">type</span> OverseasProxy <span class="keyword">struct</span> &#123;</span><br><span class="line">	shopping Shopping <span class="comment">//代理某个主题，这里是抽象类型</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(op *OverseasProxy)</span></span> Buy(goods *Goods) &#123;</span><br><span class="line">	<span class="comment">// 1. 先验货</span></span><br><span class="line">	<span class="keyword">if</span> (op.distinguish(goods) == <span class="literal">true</span>) &#123;</span><br><span class="line">		<span class="comment">//2. 进行购买</span></span><br><span class="line">		op.shopping.Buy(goods) <span class="comment">//调用原被代理的具体主题任务</span></span><br><span class="line">		<span class="comment">//3 海关安检</span></span><br><span class="line">		op.check(goods)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个代理,并且配置关联被代理的主题</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewProxy</span><span class="params">(shopping Shopping)</span></span> Shopping &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;OverseasProxy&#123;shopping&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//验货流程</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(op *OverseasProxy)</span></span> distinguish(goods *Goods) <span class="type">bool</span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;对[&quot;</span>, goods.Kind,<span class="string">&quot;]进行了辨别真伪.&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> (goods.Fact == <span class="literal">false</span>) &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;发现假货&quot;</span>,goods.Kind,<span class="string">&quot;, 不应该购买。&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> goods.Fact</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//安检流程</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(op *OverseasProxy)</span></span> check(goods *Goods) &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;对[&quot;</span>,goods.Kind,<span class="string">&quot;] 进行了海关检查， 成功的带回祖国&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	g1 := Goods&#123;</span><br><span class="line">		Kind: <span class="string">&quot;韩国面膜&quot;</span>,</span><br><span class="line">		Fact: <span class="literal">true</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	g2 := Goods&#123;</span><br><span class="line">		Kind: <span class="string">&quot;CET4证书&quot;</span>,</span><br><span class="line">		Fact: <span class="literal">false</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果不使用代理来完成从韩国购买任务</span></span><br><span class="line">	<span class="keyword">var</span> shopping Shopping</span><br><span class="line">	shopping = <span class="built_in">new</span>(KoreaShopping) <span class="comment">//具体的购买主题</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//1-先验货</span></span><br><span class="line">	<span class="keyword">if</span> g1.Fact == <span class="literal">true</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;对[&quot;</span>, g1.Kind,<span class="string">&quot;]进行了辨别真伪.&quot;</span>)</span><br><span class="line">		<span class="comment">//2-去韩国购买</span></span><br><span class="line">		shopping.Buy(&amp;g1)</span><br><span class="line">		<span class="comment">//3-海关安检</span></span><br><span class="line">		fmt.Println(<span class="string">&quot;对[&quot;</span>,g1.Kind,<span class="string">&quot;] 进行了海关检查， 成功的带回祖国&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;---------------以下是 使用 代理模式-------&quot;</span>)</span><br><span class="line">	<span class="keyword">var</span> overseasProxy Shopping</span><br><span class="line">	overseasProxy = NewProxy(shopping)</span><br><span class="line">	overseasProxy.Buy(&amp;g1)</span><br><span class="line">	overseasProxy.Buy(&amp;g2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<p>运行结果如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">对[ 韩国面膜 ]进行了辨别真伪.</span><br><span class="line">去韩国进行了购物, 买了  韩国面膜</span><br><span class="line">对[ 韩国面膜 ] 进行了海关检查， 成功的带回祖国</span><br><span class="line">---------------以下是 使用 代理模式-------</span><br><span class="line">对[ 韩国面膜 ]进行了辨别真伪.</span><br><span class="line">去韩国进行了购物, 买了  韩国面膜</span><br><span class="line">对[ 韩国面膜 ] 进行了海关检查， 成功的带回祖国</span><br><span class="line">对[ CET4证书 ]进行了辨别真伪.</span><br><span class="line">发现假货 CET4证书 , 不应该购买。</span><br></pre></td></tr></table></figure></div>



<h3 id="4-1-3-代理模式纯理解案例"><a href="#4-1-3-代理模式纯理解案例" class="headerlink" title="4.1.3 代理模式纯理解案例"></a>4.1.3 代理模式纯理解案例</h3><div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//抽象主题</span></span><br><span class="line"><span class="keyword">type</span> BeautyWoman <span class="keyword">interface</span> &#123;</span><br><span class="line">	<span class="comment">//对男人抛媚眼</span></span><br><span class="line">	MakeEyesWithMan()</span><br><span class="line">	<span class="comment">//和男人浪漫的约会</span></span><br><span class="line">	HappyWithMan()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//具体主题</span></span><br><span class="line"><span class="keyword">type</span> PanJinLian <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//对男人抛媚眼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *PanJinLian)</span></span> MakeEyesWithMan() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;潘金莲对本官抛了个媚眼&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//和男人浪漫的约会</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *PanJinLian)</span></span> HappyWithMan() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;潘金莲和本官共度了浪漫的约会。&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//代理中介人, 王婆</span></span><br><span class="line"><span class="keyword">type</span> WangPo <span class="keyword">struct</span> &#123;</span><br><span class="line">	woman BeautyWoman</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewProxy</span><span class="params">(woman BeautyWoman)</span></span> BeautyWoman &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;WangPo&#123;woman&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//对男人抛媚眼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *WangPo)</span></span> MakeEyesWithMan() &#123;</span><br><span class="line">	p.woman.MakeEyesWithMan()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//和男人浪漫的约会</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *WangPo)</span></span> HappyWithMan() &#123;</span><br><span class="line">	p.woman.HappyWithMan()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//西门大官人</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//大官人想找金莲，让王婆来安排</span></span><br><span class="line">	wangpo := NewProxy(<span class="built_in">new</span>(PanJinLian))</span><br><span class="line">	<span class="comment">//王婆命令潘金莲抛媚眼</span></span><br><span class="line">	wangpo.MakeEyesWithMan()</span><br><span class="line">	<span class="comment">//王婆命令潘金莲和西门庆约会</span></span><br><span class="line">	wangpo.HappyWithMan()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>情节自己脑补，结果如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">潘金莲对本官抛了个媚眼</span><br><span class="line">潘金莲和本官共度了浪漫的约会。</span><br></pre></td></tr></table></figure></div>



<h3 id="4-1-4-代理模式的优缺点"><a href="#4-1-4-代理模式的优缺点" class="headerlink" title="4.1.4 代理模式的优缺点"></a>4.1.4 代理模式的优缺点</h3><p>优点：</p>
<p>(1) 能够协调调用者和被调用者，在一定程度上降低了系统的耦合度。</p>
<p>(2) 客户端可以针对抽象主题角色进行编程，增加和更换代理类无须修改源代码，符合开闭原则，系统具有较好的灵活性和可扩展性。</p>
<p>缺点：</p>
<p>(1) 代理实现较为复杂。</p>
<h3 id="4-1-5-适用场景"><a href="#4-1-5-适用场景" class="headerlink" title="4.1.5 适用场景"></a>4.1.5 适用场景</h3><p>​	为其他对象提供一种代理以控制对这个对象的访问。</p>
<h2 id="4-2-装饰模式"><a href="#4-2-装饰模式" class="headerlink" title="4.2 装饰模式"></a>4.2 装饰模式</h2><p>装饰模式(Decorator Pattern)：动态地给一个对象增加一些额外的职责，就增加对象功能来说，装饰模式比生成子类实现更为灵活。装饰模式是一种对象结构型模式。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656664125487-05c58b9d-f3b7-4f39-a93c-0ecd2fee7b70.png"
                      alt="img"
                ></p>
<p>以上图为例，一开始有个手机（裸机Phone类），如果需要不断的为这个Phone增添某个功能从而变成一个新功能的Phone，就需要一个装饰器的类，来动态的给一个类额外添加一个指定的功能，而生成另一个类，但原先的类又没有改变，不影响原有系统的稳定。</p>
<p>在装饰器模式中，“裸机”、“有贴膜的手机”、“有手机壳的手机”、“有手机壳&amp;贴膜的手机”都是一个构件。</p>
<p>“贴膜装饰器”、“手机壳装饰器”是装饰器也是一个构件。</p>
<h3 id="4-2-1-装饰模式中的角色和职责"><a href="#4-2-1-装饰模式中的角色和职责" class="headerlink" title="4.2.1 装饰模式中的角色和职责"></a>4.2.1 装饰模式中的角色和职责</h3><p><strong>Component（抽象构件）</strong>：它是具体构件和抽象装饰类的共同父类，声明了在具体构件中实现的业务方法，它的引入可以使客户端以一致的方式处理未被装饰的对象以及装饰之后的对象，实现客户端的透明操作。</p>
<p><strong>ConcreteComponent（具体构件）</strong>：它是抽象构件类的子类，用于定义具体的构件对象，实现了在抽象构件中声明的方法，装饰器可以给它增加额外的职责（方法）。</p>
<p>其标准的类图如下所示：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656667803732-b8414e41-ca15-4033-834c-ff078ad46409.jpeg"
                      alt="img"
                ></p>
<h3 id="4-2-2-装饰模式中的代码实现"><a href="#4-2-2-装饰模式中的代码实现" class="headerlink" title="4.2.2 装饰模式中的代码实现"></a>4.2.2 装饰模式中的代码实现</h3><p>接下来按照上述手机案例，结合装饰器的设计模式特点，得到对应案例的类图，如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656667806705-0d0ec66c-c60b-436d-ae64-fb538d3b108b.jpeg"
                      alt="img"
                ></p>
<p>实现的代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------- 抽象层 ----------</span></span><br><span class="line"><span class="comment">//抽象的构件</span></span><br><span class="line"><span class="keyword">type</span> Phone <span class="keyword">interface</span> &#123;</span><br><span class="line">	Show() <span class="comment">//构件的功能</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//装饰器基础类（该类本应该为interface，但是Golang interface语法不可以有成员属性）</span></span><br><span class="line"><span class="keyword">type</span> Decorator <span class="keyword">struct</span> &#123;</span><br><span class="line">	phone Phone</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *Decorator)</span></span> Show() &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ----------- 实现层 -----------</span></span><br><span class="line"><span class="comment">// 具体的构件</span></span><br><span class="line"><span class="keyword">type</span> HuaWei <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(hw *HuaWei)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;秀出了HuaWei手机&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> XiaoMi <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(xm *XiaoMi)</span></span> Show() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;秀出了XiaoMi手机&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体的装饰器类</span></span><br><span class="line"><span class="keyword">type</span> MoDecorator <span class="keyword">struct</span> &#123;</span><br><span class="line">	Decorator   <span class="comment">//继承基础装饰器类(主要继承Phone成员属性)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(md *MoDecorator)</span></span> Show() &#123;</span><br><span class="line">	md.phone.Show() <span class="comment">//调用被装饰构件的原方法</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;贴膜的手机&quot;</span>) <span class="comment">//装饰额外的方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewMoDecorator</span><span class="params">(phone Phone)</span></span> Phone &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;MoDecorator&#123;Decorator&#123;phone&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> KeDecorator <span class="keyword">struct</span> &#123;</span><br><span class="line">	Decorator   <span class="comment">//继承基础装饰器类(主要继承Phone成员属性)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(kd *KeDecorator)</span></span> Show() &#123;</span><br><span class="line">	kd.phone.Show()</span><br><span class="line">	fmt.Println(<span class="string">&quot;手机壳的手机&quot;</span>) <span class="comment">//装饰额外的方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewKeDecorator</span><span class="params">(phone Phone)</span></span> Phone &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;KeDecorator&#123;Decorator&#123;phone&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ------------ 业务逻辑层 ---------</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> huawei Phone</span><br><span class="line">	huawei = <span class="built_in">new</span>(HuaWei)</span><br><span class="line">	huawei.Show()	 <span class="comment">//调用原构件方法</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;---------&quot;</span>)</span><br><span class="line">	<span class="comment">//用贴膜装饰器装饰，得到新功能构件</span></span><br><span class="line">	<span class="keyword">var</span> moHuawei Phone</span><br><span class="line">	moHuawei = NewMoDecorator(huawei) <span class="comment">//通过HueWei ---&gt; MoHuaWei</span></span><br><span class="line">	moHuawei.Show() <span class="comment">//调用装饰后新构件的方法</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;---------&quot;</span>)</span><br><span class="line">	<span class="keyword">var</span> keHuawei Phone</span><br><span class="line">	keHuawei = NewKeDecorator(huawei) <span class="comment">//通过HueWei ---&gt; KeHuaWei</span></span><br><span class="line">	keHuawei.Show()</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;---------&quot;</span>)</span><br><span class="line">	<span class="keyword">var</span> keMoHuaWei Phone</span><br><span class="line">	keMoHuaWei = NewMoDecorator(keHuawei) <span class="comment">//通过KeHuaWei ---&gt; KeMoHuaWei</span></span><br><span class="line">	keMoHuaWei.Show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>运行结果如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">秀出了HuaWei手机</span><br><span class="line">---------</span><br><span class="line">秀出了HuaWei手机</span><br><span class="line">贴膜的手机</span><br><span class="line">---------</span><br><span class="line">秀出了HuaWei手机</span><br><span class="line">手机壳的手机</span><br><span class="line">---------</span><br><span class="line">秀出了HuaWei手机</span><br><span class="line">手机壳的手机</span><br><span class="line">贴膜的手机</span><br></pre></td></tr></table></figure></div>



<h3 id="4-2-3-装饰模式的优缺点"><a href="#4-2-3-装饰模式的优缺点" class="headerlink" title="4.2.3 装饰模式的优缺点"></a>4.2.3 装饰模式的优缺点</h3><p>优点：</p>
<p>(1) 对于扩展一个对象的功能，装饰模式比继承更加灵活性，不会导致类的个数急剧增加。</p>
<p>(2) 可以通过一种动态的方式来扩展一个对象的功能，从而实现不同的行为。</p>
<p>(3) 可以对一个对象进行多次装饰。</p>
<p>(4) 具体构件类与具体装饰类可以独立变化，用户可以根据需要增加新的具体构件类和具体装饰类，原有类库代码无须改变，符合“开闭原则”。</p>
<p>缺点：</p>
<p>(1) 使用装饰模式进行系统设计时将产生很多小对象，大量小对象的产生势必会占用更多的系统资源，影响程序的性能。</p>
<p>(2) 装饰模式提供了一种比继承更加灵活机动的解决方案，但同时也意味着比继承更加易于出错，排错也很困难，对于多次装饰的对象，调试时寻找错误可能需要逐级排查，较为繁琐。</p>
<h3 id="4-2-3-适用场景"><a href="#4-2-3-适用场景" class="headerlink" title="4.2.3 适用场景"></a>4.2.3 适用场景</h3><p>(1) 动态、透明的方式给单个对象添加职责。</p>
<p>(2) 当不能采用继承的方式对系统进行扩展或者采用继承不利于系统扩展和维护时可以使用装饰模式。</p>
<p>装饰器模式关注于在一个对象上动态的添加方法，然而代理模式关注于控制对对象的访问。换句话说，用代理模式，代理类（proxy class）可以对它的客户隐藏一个对象的具体信息。因此，当使用代理模式的时候，我们常常在一个代理类中创建一个对象的实例。并且，当我们使用装饰器模式的时候，我们通常的做法是将原始对象作为一个参数传给装饰者的构造器。</p>
<h2 id="4-3-适配器模式"><a href="#4-3-适配器模式" class="headerlink" title="4.3 适配器模式"></a>4.3 适配器模式</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656924938630-c6ea1182-2c77-4596-96e5-4a47a8d86bb5.png"
                      alt="image.png"
                ></p>
<p>5V	 &lt;————&gt;                     适配器	      &lt;————&gt;	     220V </p>
<p>将一个类的接口转换成客户希望的另外一个接口。使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</p>
<h3 id="4-3-1-适配器模式中的角色和职责"><a href="#4-3-1-适配器模式中的角色和职责" class="headerlink" title="4.3.1 适配器模式中的角色和职责"></a>4.3.1 适配器模式中的角色和职责</h3><p>适配器模式的标准类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656929503296-69d34009-1251-44ef-b55d-3a7d640640c1.jpeg"
                      alt="img"
                ></p>
<p><strong>Target（目标抽象类）：</strong>目标抽象类定义客户所需接口，可以是一个抽象类或接口，也可以是具体类。</p>
<p><strong>Adapter（适配器类）：</strong>适配器可以调用另一个接口，作为一个转换器，对Adaptee和Target进行适配，适配器类是适配器模式的核心，在对象适配器中，它通过继承Target并关联一个Adaptee对象使二者产生联系。</p>
<p><strong>Adaptee（适配者类）：</strong>适配者即被适配的角色，它定义了一个已经存在的接口，这个接口需要适配，适配者类一般是一个具体类，包含了客户希望使用的业务方法，在某些情况下可能没有适配者类的源代码。</p>
<p>根据对象适配器模式结构图，在对象适配器中，客户端需要调用request()方法，而适配者类Adaptee没有该方法，但是它所提供的specificRequest()方法却是客户端所需要的。为了使客户端能够使用适配者类，需要提供一个包装类Adapter，即适配器类。这个包装类包装了一个适配者的实例，从而将客户端与适配者衔接起来，在适配器的request()方法中调用适配者的specificRequest()方法。因为适配器类与适配者类是关联关系（也可称之为委派关系），所以这种适配器模式称为对象适配器模式。</p>
<h3 id="4-3-2-适配器模式的代码实现"><a href="#4-3-2-适配器模式的代码实现" class="headerlink" title="4.3.2 适配器模式的代码实现"></a>4.3.2 适配器模式的代码实现</h3><p>按照上述的例子，来重新设计类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1663246766976-ee2f4d57-ba40-435d-884c-e4727638c584.jpeg"
                      alt="img"
                ></p>
<p>实现的代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//适配的目标</span></span><br><span class="line"><span class="keyword">type</span> V5 <span class="keyword">interface</span> &#123;</span><br><span class="line">	Use5V()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//业务类，依赖V5接口</span></span><br><span class="line"><span class="keyword">type</span> Phone <span class="keyword">struct</span> &#123;</span><br><span class="line">	v V5</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewPhone</span><span class="params">(v V5)</span></span> *Phone &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Phone&#123;v&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Phone)</span></span> Charge() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Phone进行充电...&quot;</span>)</span><br><span class="line">	p.v.Use5V()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//被适配的角色，适配者</span></span><br><span class="line"><span class="keyword">type</span> V220 <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v *V220)</span></span> Use220V() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;使用220V的电压&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//电源适配器</span></span><br><span class="line"><span class="keyword">type</span> Adapter <span class="keyword">struct</span> &#123;</span><br><span class="line">	v220 *V220</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *Adapter)</span></span> Use5V() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;使用适配器进行充电&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//调用适配者的方法</span></span><br><span class="line">	a.v220.Use220V()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewAdapter</span><span class="params">(v220 *V220)</span></span> *Adapter &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Adapter&#123;v220&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ------- 业务逻辑层 -------</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	iphone := NewPhone(NewAdapter(<span class="built_in">new</span>(V220)))</span><br><span class="line"></span><br><span class="line">	iphone.Charge()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>运行结果如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Phone进行充电...</span><br><span class="line">使用适配器进行充电</span><br><span class="line">使用<span class="number">220</span>V的电压</span><br></pre></td></tr></table></figure></div>



<h3 id="4-3-3-适配器模式优缺点"><a href="#4-3-3-适配器模式优缺点" class="headerlink" title="4.3.3 适配器模式优缺点"></a>4.3.3 适配器模式优缺点</h3><p>优点：</p>
<p>(1) 将目标类和适配者类解耦，通过引入一个适配器类来重用现有的适配者类，无须修改原有结构。</p>
<p>(2) 增加了类的透明性和复用性，将具体的业务实现过程封装在适配者类中，对于客户端类而言是透明的，而且提高了适配者的复用性，同一个适配者类可以在多个不同的系统中复用。</p>
<p>(3) 灵活性和扩展性都非常好，可以很方便地更换适配器，也可以在不修改原有代码的基础上增加新的适配器类，完全符合“开闭原则”。</p>
<p>缺点:</p>
<p>适配器中置换适配者类的某些方法比较麻烦。</p>
<h3 id="4-3-4-适应场景"><a href="#4-3-4-适应场景" class="headerlink" title="4.3.4 适应场景"></a>4.3.4 适应场景</h3><p>(1) 系统需要使用一些现有的类，而这些类的接口（如方法名）不符合系统的需要，甚至没有这些类的源代码。</p>
<p>(2) 想创建一个可以重复使用的类，用于与一些彼此之间没有太大关联的一些类，包括一些可能在将来引进的类一起工作。</p>
<p>根据迪米特法则，如果两个类不必彼此直接通信，那么这两个类就不应当发生直接的相互作用。</p>
<p>​	Facade模式也叫外观模式，是由GoF提出的23种设计模式中的一种。Facade模式为一组具有类似功能的类群，比如类库，子系统等等，提供一个一致的简单的界面。这个一致的简单的界面被称作facade。</p>
<h2 id="4-4外观模式"><a href="#4-4外观模式" class="headerlink" title="4.4外观模式"></a>4.4外观模式</h2><h3 id="4-4-1-外观模式中角色和职责"><a href="#4-4-1-外观模式中角色和职责" class="headerlink" title="4.4.1 外观模式中角色和职责"></a>4.4.1 外观模式中角色和职责</h3><p>外观模式的标准类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1656990720819-a5bb303c-f7f1-446e-bb11-dbb87443eade.jpeg"
                      alt="img"
                ></p>
<p><strong>Façade(外观角色)：</strong>为调用方, 定义简单的调用接口。</p>
<p><strong>SubSystem(子系统角色)：</strong>功能提供者。指提供功能的类群（模块或子系统）。</p>
<h3 id="4-4-2-外观模式的代码实现"><a href="#4-4-2-外观模式的代码实现" class="headerlink" title="4.4.2 外观模式的代码实现"></a>4.4.2 外观模式的代码实现</h3><p>外观模式相对简单一些，代码实现如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> SubSystemA <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sa *SubSystemA)</span></span> MethodA() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;子系统方法A&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> SubSystemB <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sb *SubSystemB)</span></span> MethodB() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;子系统方法B&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> SubSystemC <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sc *SubSystemC)</span></span> MethodC() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;子系统方法C&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> SubSystemD <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sd *SubSystemD)</span></span> MethodD() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;子系统方法D&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//外观模式，提供了一个外观类， 简化成一个简单的接口供使用</span></span><br><span class="line"><span class="keyword">type</span> Facade <span class="keyword">struct</span> &#123;</span><br><span class="line">	a *SubSystemA</span><br><span class="line">	b *SubSystemB</span><br><span class="line">	c *SubSystemC</span><br><span class="line">	d *SubSystemD</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *Facade)</span></span> MethodOne() &#123;</span><br><span class="line">	f.a.MethodA()</span><br><span class="line">	f.b.MethodB()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *Facade)</span></span> MethodTwo() &#123;</span><br><span class="line">	f.c.MethodC()</span><br><span class="line">	f.d.MethodD()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//如果不用外观模式实现MethodA() 和 MethodB()</span></span><br><span class="line">	sa := <span class="built_in">new</span>(SubSystemA)</span><br><span class="line">	sa.MethodA()</span><br><span class="line">	sb := <span class="built_in">new</span>(SubSystemB)</span><br><span class="line">	sb.MethodB()</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;-----------&quot;</span>)</span><br><span class="line">	<span class="comment">//使用外观模式</span></span><br><span class="line">	f := Facade&#123;</span><br><span class="line">		a: <span class="built_in">new</span>(SubSystemA),</span><br><span class="line">		b: <span class="built_in">new</span>(SubSystemB),</span><br><span class="line">		c: <span class="built_in">new</span>(SubSystemC),</span><br><span class="line">		d: <span class="built_in">new</span>(SubSystemD),</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//调用外观包裹方法</span></span><br><span class="line">	f.MethodOne()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>结果如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">子系统方法A</span><br><span class="line">子系统方法B</span><br><span class="line">-----------</span><br><span class="line">子系统方法A</span><br><span class="line">子系统方法B</span><br></pre></td></tr></table></figure></div>



<h3 id="4-4-3-外观模式的案例"><a href="#4-4-3-外观模式的案例" class="headerlink" title="4.4.3 外观模式的案例"></a>4.4.3 外观模式的案例</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1657001531641-5feb8822-e177-4413-bf33-e93d5cdff83a.jpeg"
                      alt="img"
                ></p>
<p>代码实现如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//电视机</span></span><br><span class="line"><span class="keyword">type</span> TV <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *TV)</span></span> On() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;打开 电视机&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *TV)</span></span> Off() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;关闭 电视机&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//电视机</span></span><br><span class="line"><span class="keyword">type</span> VoiceBox <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v *VoiceBox)</span></span> On() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;打开 音箱&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v *VoiceBox)</span></span> Off() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;关闭 音箱&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//灯光</span></span><br><span class="line"><span class="keyword">type</span> Light <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Light)</span></span> On() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;打开 灯光&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *Light)</span></span> Off() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;关闭 灯光&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//游戏机</span></span><br><span class="line"><span class="keyword">type</span> Xbox <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(x *Xbox)</span></span> On() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;打开 游戏机&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(x *Xbox)</span></span> Off() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;关闭 游戏机&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//麦克风</span></span><br><span class="line"><span class="keyword">type</span> MicroPhone <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *MicroPhone)</span></span> On() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;打开 麦克风&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *MicroPhone)</span></span> Off() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;关闭 麦克风&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//投影仪</span></span><br><span class="line"><span class="keyword">type</span> Projector <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Projector)</span></span> On() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;打开 投影仪&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Projector)</span></span> Off() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;关闭 投影仪&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//家庭影院(外观)</span></span><br><span class="line"><span class="keyword">type</span> HomePlayerFacade <span class="keyword">struct</span> &#123;</span><br><span class="line">	tv TV</span><br><span class="line">	vb VoiceBox</span><br><span class="line">	light Light</span><br><span class="line">	xbox Xbox</span><br><span class="line">	mp MicroPhone</span><br><span class="line">	pro Projector</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//KTV模式</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(hp *HomePlayerFacade)</span></span> DoKTV() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;家庭影院进入KTV模式&quot;</span>)</span><br><span class="line">	hp.tv.On()</span><br><span class="line">	hp.pro.On()</span><br><span class="line">	hp.mp.On()</span><br><span class="line">	hp.light.Off()</span><br><span class="line">	hp.vb.On()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//游戏模式</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(hp *HomePlayerFacade)</span></span> DoGame() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;家庭影院进入Game模式&quot;</span>)</span><br><span class="line">	hp.tv.On()</span><br><span class="line">	hp.light.On()</span><br><span class="line">	hp.xbox.On()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	homePlayer := <span class="built_in">new</span>(HomePlayerFacade)</span><br><span class="line"></span><br><span class="line">	homePlayer.DoKTV()</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;------------&quot;</span>)</span><br><span class="line"></span><br><span class="line">	homePlayer.DoGame()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>结果如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">家庭影院进入KTV模式</span><br><span class="line">打开 电视机</span><br><span class="line">打开 投影仪</span><br><span class="line">打开 麦克风</span><br><span class="line">关闭 灯光</span><br><span class="line">打开 音箱</span><br><span class="line">------------</span><br><span class="line">家庭影院进入Game模式</span><br><span class="line">打开 电视机</span><br><span class="line">打开 灯光</span><br><span class="line">打开 游戏机</span><br></pre></td></tr></table></figure></div>



<h3 id="4-4-4-外观模式的优缺点"><a href="#4-4-4-外观模式的优缺点" class="headerlink" title="4.4.4 外观模式的优缺点"></a>4.4.4 外观模式的优缺点</h3><p>优点：</p>
<p>(1) 它对客户端屏蔽了子系统组件，减少了客户端所需处理的对象数目，并使得子系统使用起来更加容易。通过引入外观模式，客户端代码将变得很简单，与之关联的对象也很少。</p>
<p>(2) 它实现了子系统与客户端之间的松耦合关系，这使得子系统的变化不会影响到调用它的客户端，只需要调整外观类即可。</p>
<p>(3) 一个子系统的修改对其他子系统没有任何影响。</p>
<p>缺点：</p>
<p>(1) 不能很好地限制客户端直接使用子系统类，如果对客户端访问子系统类做太多的限制则减少了可变性和灵活 性。</p>
<p>(2) 如果设计不当，增加新的子系统可能需要修改外观类的源代码，违背了开闭原则。</p>
<h3 id="4-4-5-适用场景"><a href="#4-4-5-适用场景" class="headerlink" title="4.4.5 适用场景"></a>4.4.5 适用场景</h3><p>(1) 复杂系统需要简单入口使用。</p>
<p>(2) 客户端程序与多个子系统之间存在很大的依赖性。</p>
<p>(3) 在层次化结构中，可以使用外观模式定义系统中每一层的入口，层与层之间不直接产生联系，而通过外观类建立联系，降低层之间的耦合度</p>
<h1 id="五、行为型模式"><a href="#五、行为型模式" class="headerlink" title="五、行为型模式"></a>五、行为型模式</h1><h2 id="5-1模板方法模式"><a href="#5-1模板方法模式" class="headerlink" title="5.1模板方法模式"></a>5.1模板方法模式</h2><h3 id="5-1-1-模板方法模式中的角色和职责"><a href="#5-1-1-模板方法模式中的角色和职责" class="headerlink" title="5.1.1 模板方法模式中的角色和职责"></a>5.1.1 模板方法模式中的角色和职责</h3><p><strong>AbstractClass（抽象类）：</strong>在抽象类中定义了一系列基本操作(PrimitiveOperations)，这些基本操作可以是具体的，也可以是抽象的，每一个基本操作对应算法的一个步骤，在其子类中可以重定义或实现这些步骤。同时，在抽象类中实现了一个模板方法(Template Method)，用于定义一个算法的框架，模板方法不仅可以调用在抽象类中实现的基本方法，也可以调用在抽象类的子类中实现的基本方法，还可以调用其他对象中的方法。</p>
<p><strong>ConcreteClass（具体子类）：</strong>它是抽象类的子类，用于实现在父类中声明的抽象基本操作以完成子类特定算法的步骤，也可以覆盖在父类中已经实现的具体基本操作。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1657010368272-cccad8d2-2aaf-4cd9-921f-3c60535a837b.jpeg"
                      alt="img"
                ></p>
<h3 id="5-1-2-模板方法模式案例"><a href="#5-1-2-模板方法模式案例" class="headerlink" title="5.1.2 模板方法模式案例"></a>5.1.2 模板方法模式案例</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1657009531281-1e8bfaad-fde1-4e21-89f8-7f8c8c7364cc.png"
                      alt="img"
                ></p>
<p>上图的案例类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1657011490258-7354db34-6b19-456d-89fc-7e04c48ef8ed.jpeg"
                      alt="img"
                ></p>
<p>实现代码如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//抽象类，制作饮料,包裹一个模板的全部实现步骤</span></span><br><span class="line"><span class="keyword">type</span> Beverage <span class="keyword">interface</span> &#123;</span><br><span class="line">	BoilWater() <span class="comment">//煮开水</span></span><br><span class="line">	Brew()      <span class="comment">//冲泡</span></span><br><span class="line">	PourInCup() <span class="comment">//倒入杯中</span></span><br><span class="line">	AddThings() <span class="comment">//添加酌料</span></span><br><span class="line"></span><br><span class="line">	WantAddThings() <span class="type">bool</span> <span class="comment">//是否加入酌料Hook</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//封装一套流程模板，让具体的制作流程继承且实现</span></span><br><span class="line"><span class="keyword">type</span> template <span class="keyword">struct</span> &#123;</span><br><span class="line">	b Beverage</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//封装的固定模板</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *template)</span></span> MakeBeverage() &#123;</span><br><span class="line">	<span class="keyword">if</span> t == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	t.b.BoilWater()</span><br><span class="line">	t.b.Brew()</span><br><span class="line">	t.b.PourInCup()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//子类可以重写该方法来决定是否执行下面动作</span></span><br><span class="line">	<span class="keyword">if</span> t.b.WantAddThings() == <span class="literal">true</span> &#123;</span><br><span class="line">		t.b.AddThings()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的模板子类 制作咖啡</span></span><br><span class="line"><span class="keyword">type</span> MakeCaffee <span class="keyword">struct</span> &#123;</span><br><span class="line">	template  <span class="comment">//继承模板</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewMakeCaffee</span><span class="params">()</span></span> *MakeCaffee &#123;</span><br><span class="line">	makeCaffe := <span class="built_in">new</span>(MakeCaffee)</span><br><span class="line">	<span class="comment">//b 为Beverage，是MakeCaffee的接口，这里需要给接口赋值，指向具体的子类对象</span></span><br><span class="line">	<span class="comment">//来触发b全部接口方法的多态特性。</span></span><br><span class="line">	makeCaffe.b = makeCaffe</span><br><span class="line">	<span class="keyword">return</span> makeCaffe</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mc *MakeCaffee)</span></span> BoilWater() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;将水煮到100摄氏度&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mc *MakeCaffee)</span></span> Brew() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;用水冲咖啡豆&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mc *MakeCaffee)</span></span> PourInCup() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;将充好的咖啡倒入陶瓷杯中&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mc *MakeCaffee)</span></span> AddThings() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;添加牛奶和糖&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mc *MakeCaffee)</span></span> WantAddThings() <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span> <span class="comment">//启动Hook条件</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的模板子类 制作茶</span></span><br><span class="line"><span class="keyword">type</span> MakeTea <span class="keyword">struct</span> &#123;</span><br><span class="line">	template  <span class="comment">//继承模板</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewMakeTea</span><span class="params">()</span></span> *MakeTea &#123;</span><br><span class="line">	makeTea := <span class="built_in">new</span>(MakeTea)</span><br><span class="line">	<span class="comment">//b 为Beverage，是MakeTea，这里需要给接口赋值，指向具体的子类对象</span></span><br><span class="line">	<span class="comment">//来触发b全部接口方法的多态特性。</span></span><br><span class="line">	makeTea.b = makeTea</span><br><span class="line">	<span class="keyword">return</span> makeTea</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mt *MakeTea)</span></span> BoilWater() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;将水煮到80摄氏度&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mt *MakeTea)</span></span> Brew() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;用水冲茶叶&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mt *MakeTea)</span></span> PourInCup() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;将充好的咖啡倒入茶壶中&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mt *MakeTea)</span></span> AddThings() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;添加柠檬&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mt *MakeTea)</span></span> WantAddThings() <span class="type">bool</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span> <span class="comment">//关闭Hook条件</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//1. 制作一杯咖啡</span></span><br><span class="line">	makeCoffee := NewMakeCaffee()</span><br><span class="line">	makeCoffee.MakeBeverage() <span class="comment">//调用固定模板方法</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;------------&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2. 制作茶</span></span><br><span class="line">	makeTea := NewMakeTea()</span><br><span class="line">	makeTea.MakeBeverage()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<p>运行结果如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">将水煮到100摄氏度</span><br><span class="line">用水冲咖啡豆</span><br><span class="line">将充好的咖啡倒入陶瓷杯中</span><br><span class="line">添加牛奶和糖</span><br><span class="line">------------</span><br><span class="line">将水煮到80摄氏度</span><br><span class="line">用水冲茶叶</span><br><span class="line">将充好的咖啡倒入茶壶中</span><br></pre></td></tr></table></figure></div>



<h3 id="5-1-3-模板方法的优缺点"><a href="#5-1-3-模板方法的优缺点" class="headerlink" title="5.1.3 模板方法的优缺点"></a>5.1.3 模板方法的优缺点</h3><p>优点：</p>
<p>(1) 在父类中形式化地定义一个算法，而由它的子类来实现细节的处理，在子类实现详细的处理算法时并不会改变算法中步骤的执行次序。</p>
<p>(2) 模板方法模式是一种代码复用技术，它在类库设计中尤为重要，它提取了类库中的公共行为，将公共行为放在父类中，而通过其子类来实现不同的行为，它鼓励我们恰当使用继承来实现代码复用。</p>
<p>(3) 可实现一种反向控制结构，通过子类覆盖父类的钩子方法来决定某一特定步骤是否需要执行。</p>
<p>(4) 在模板方法模式中可以通过子类来覆盖父类的基本方法，不同的子类可以提供基本方法的不同实现，更换和增加新的子类很方便，符合单一职责原则和开闭原则。</p>
<p>缺点：</p>
<p>需要为每一个基本方法的不同实现提供一个子类，如果父类中可变的基本方法太多，将会导致类的个数增加，系统更加庞大，设计也更加抽象。</p>
<h3 id="5-1-4-适用场景"><a href="#5-1-4-适用场景" class="headerlink" title="5.1.4 适用场景"></a>5.1.4 适用场景</h3><p>(1)具有统一的操作步骤或操作过程;</p>
<p>(2) 具有不同的操作细节;</p>
<p>(3) 存在多个具有同样操作步骤的应用场景，但某些具体的操作细节却各不相同;</p>
<p>在抽象类中统一操作步骤，并规定好接口；让子类实现接口。这样可以把各个具体的子类和操作步骤解耦合。</p>
<h2 id="5-2命令模式"><a href="#5-2命令模式" class="headerlink" title="5.2命令模式"></a>5.2命令模式</h2><p>假设你实现了开启和关闭电视机的功能，随着业务迭代，还需要实现开启和关闭冰箱的功能，开启和关闭电灯的功能，开启和关闭微波炉的功能……这些功能都基于你的基类，开启和关闭。如果你之后对基类进行修改，很可能会影响到其他功能，这使项目变得不稳定了。</p>
<p>一个优秀的设计往往会关注于软件的分层与解耦，命令模式试图做到这样的结果：让命令和对应功能解耦，并能根据不同的请求将其方法参数化。</p>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>还是用开启和关闭家用电器的例子来举例吧。请看以下代码：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> command</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求者</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> button <span class="keyword">struct</span> &#123;</span><br><span class="line">  command command</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *button)</span></span> press() &#123;</span><br><span class="line">  b.command.execute()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体命令接口</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> command <span class="keyword">interface</span> &#123;</span><br><span class="line">  execute()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> onCommand <span class="keyword">struct</span> &#123;</span><br><span class="line">  device device</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *onCommand)</span></span> execute() &#123;</span><br><span class="line">  c.device.on()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> offCommand <span class="keyword">struct</span> &#123;</span><br><span class="line">  device device</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *offCommand)</span></span> execute() &#123;</span><br><span class="line">  c.device.off()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接收者</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> device <span class="keyword">interface</span> &#123;</span><br><span class="line">  on()</span><br><span class="line">  off()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> tv <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *tv)</span></span> on() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;Turning tv on&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *tv)</span></span> off() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;Turning tv off&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> airConditioner <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *airConditioner)</span></span> on() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;Turning air conditioner on&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *airConditioner)</span></span> off() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;Turning air conditioner off&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>我们分别实现了请求者button，命令接口command，接收者device。请求者button就像是那个可以执行开启或关闭的遥控器，命令接口command则是一个中间层，它使我们的请求者和接收者解藕。</p>
<p>测试代码：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> command</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleCommand</span><span class="params">()</span></span> &#123;</span><br><span class="line">  Tv()</span><br><span class="line">  AirConditioner()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Output:</span></span><br><span class="line">  <span class="comment">// Turning tv on</span></span><br><span class="line">  <span class="comment">// Turning tv off</span></span><br><span class="line">  <span class="comment">// Turning air conditioner on</span></span><br><span class="line">  <span class="comment">// Turning air conditioner off</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Tv</span><span class="params">()</span></span> &#123;</span><br><span class="line">  tv := &amp;tv&#123;&#125;</span><br><span class="line"></span><br><span class="line">  onTvCommand := &amp;onCommand&#123;</span><br><span class="line">    device: tv,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  offTvCommand := &amp;offCommand&#123;</span><br><span class="line">    device: tv,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onTvButton := &amp;button&#123;</span><br><span class="line">    command: onTvCommand,</span><br><span class="line">  &#125;</span><br><span class="line">  onTvButton.press()</span><br><span class="line"></span><br><span class="line">  offTvButton := &amp;button&#123;</span><br><span class="line">    command: offTvCommand,</span><br><span class="line">  &#125;</span><br><span class="line">  offTvButton.press()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AirConditioner</span><span class="params">()</span></span> &#123;</span><br><span class="line">  airConditioner := &amp;airConditioner&#123;&#125;</span><br><span class="line"></span><br><span class="line">  onAirConditionerCommand := &amp;onCommand&#123;</span><br><span class="line">    device: airConditioner,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  offAirConditionerCommand := &amp;offCommand&#123;</span><br><span class="line">    device: airConditioner,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onAirConditionerButton := &amp;button&#123;</span><br><span class="line">    command: onAirConditionerCommand,</span><br><span class="line">  &#125;</span><br><span class="line">  onAirConditionerButton.press()</span><br><span class="line"></span><br><span class="line">  offAirConditionerButton := &amp;button&#123;</span><br><span class="line">    command: offAirConditionerCommand,</span><br><span class="line">  &#125;</span><br><span class="line">  offAirConditionerButton.press()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h3 id="命令模式的优缺点"><a href="#命令模式的优缺点" class="headerlink" title="命令模式的优缺点"></a>命令模式的优缺点</h3><p>优点：</p>
<p>(1) 降低系统的耦合度。由于请求者与接收者之间不存在直接引用，因此请求者与接收者之间实现完全解耦，相同的请求者可以对应不同的接收者，同样，相同的接收者也可以供不同的请求者使用，两者之间具有良好的独立性。</p>
<p>(2) 新的命令可以很容易地加入到系统中。由于增加新的具体命令类不会影响到其他类，因此增加新的具体命令类很容易，无须修改原有系统源代码，甚至客户类代码，满足“开闭原则”的要求。</p>
<p>(3) 可以比较容易地设计一个命令队列或宏命令（组合命令）。</p>
<p>缺点：</p>
<p>使用命令模式可能会导致某些系统有过多的具体命令类。因为针对每一个对请求接收者的调用操作都需要设计一个具体命令类，因此在某些系统中可能需要提供大量的具体命令类，这将影响命令模式的使用。</p>
<h3 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h3><p>(1) 系统需要将请求调用者和请求接收者解耦，使得调用者和接收者不直接交互。请求调用者无须知道接收者的存在，也无须知道接收者是谁，接收者也无须关心何时被调用。</p>
<p>(2) 系统需要在不同的时间指定请求、将请求排队和执行请求。一个命令对象和请求的初始调用者可以有不同的生命期，换言之，最初的请求发出者可能已经不在了，而命令对象本身仍然是活动的，可以通过该命令对象去调用请求接收者，而无须关心请求调用者的存在性，可以通过请求日志文件等机制来具体实现。</p>
<p>(3) 系统需要将一组操作组合在一起形成宏命令。</p>
<h2 id="5-3策略模式"><a href="#5-3策略模式" class="headerlink" title="5.3策略模式"></a>5.3策略模式</h2><h3 id="5-3-1-策略模式中的角色和职责"><a href="#5-3-1-策略模式中的角色和职责" class="headerlink" title="5.3.1 策略模式中的角色和职责"></a>5.3.1 策略模式中的角色和职责</h3><p>策略模式的标准类图如下：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1657165666787-22e84d8c-fdd2-49c5-89ca-c1dd629083b8.jpeg"
                      alt="img"
                ></p>
<p><strong>Context（环境类）</strong>：环境类是使用算法的角色，它在解决某个问题（即实现某个方法）时可以采用多种策略。在环境类中维持一个对抽象策略类的引用实例，用于定义所采用的策略。</p>
<p><strong>Strategy（抽象策略类）</strong>：它为所支持的算法声明了抽象方法，是所有策略类的父类，它可以是抽象类或具体类，也可以是接口。环境类通过抽象策略类中声明的方法在运行时调用具体策略类中实现的算法。</p>
<p><strong>ConcreteStrategy（具体策略类）</strong>：它实现了在抽象策略类中声明的算法，在运行时，具体策略类将覆盖在环境类中定义的抽象策略类对象，使用一种具体的算法实现某个业务处理。</p>
<h3 id="5-3-2-策略模式案例"><a href="#5-3-2-策略模式案例" class="headerlink" title="5.3.2 策略模式案例"></a>5.3.2 策略模式案例</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/images/1657165787446-4d88fb97-bdb9-4da5-aa4b-003bec7f366b.jpeg"
                      alt="img"
                ></p>
<p>代码实现如下：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//武器策略(抽象的策略)</span></span><br><span class="line"><span class="keyword">type</span> WeaponStrategy <span class="keyword">interface</span> &#123;</span><br><span class="line">	UseWeapon()  <span class="comment">//使用武器</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的策略</span></span><br><span class="line"><span class="keyword">type</span> Ak47 <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ak *Ak47)</span></span> UseWeapon() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;使用Ak47 去战斗&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的策略</span></span><br><span class="line"><span class="keyword">type</span> Knife <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(k *Knife)</span></span> UseWeapon() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;使用匕首 去战斗&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//环境类</span></span><br><span class="line"><span class="keyword">type</span> Hero <span class="keyword">struct</span> &#123;</span><br><span class="line">	strategy WeaponStrategy <span class="comment">//拥有一个抽象的策略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置一个策略</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *Hero)</span></span> SetWeaponStrategy(s WeaponStrategy) &#123;</span><br><span class="line">	h.strategy = s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *Hero)</span></span> Fight() &#123;</span><br><span class="line">	h.strategy.UseWeapon() <span class="comment">//调用策略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	hero := Hero&#123;&#125;</span><br><span class="line">	<span class="comment">//更换策略1</span></span><br><span class="line">	hero.SetWeaponStrategy(<span class="built_in">new</span>(Ak47))</span><br><span class="line">	hero.Fight()</span><br><span class="line"></span><br><span class="line">	hero.SetWeaponStrategy(<span class="built_in">new</span>(Knife))</span><br><span class="line">	hero.Fight()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>运行结果如下：</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用Ak47 去战斗</span><br><span class="line">使用匕首 去战斗</span><br></pre></td></tr></table></figure></div>



<p>练习：</p>
<p>​	商场促销有策略A（0.8折）策略B（消费满200，返现100），用策略模式模拟场景</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	练习：</span></span><br><span class="line"><span class="comment">	商场促销有策略A（0.8折）策略B（消费满200，返现100），用策略模式模拟场景</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//销售策略</span></span><br><span class="line"><span class="keyword">type</span> SellStrategy <span class="keyword">interface</span> &#123;</span><br><span class="line">	<span class="comment">//根据原价得到售卖价</span></span><br><span class="line">	GetPrice(price <span class="type">float64</span>)	 <span class="type">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> StrategyA <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sa *StrategyA)</span></span> GetPrice(price <span class="type">float64</span>) <span class="type">float64</span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;执行策略A, 所有商品打八折&quot;</span>)</span><br><span class="line">	<span class="keyword">return</span> price * <span class="number">0.8</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> StrategyB <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sb *StrategyB)</span></span> GetPrice(price <span class="type">float64</span>) <span class="type">float64</span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;执行策略B, 所有商品满200 减100&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> price &gt;= <span class="number">200</span> &#123;</span><br><span class="line">		price -= <span class="number">100</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> price;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//环境类</span></span><br><span class="line"><span class="keyword">type</span> Goods <span class="keyword">struct</span> &#123;</span><br><span class="line">	Price <span class="type">float64</span></span><br><span class="line">	Strategy SellStrategy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *Goods)</span></span> SetStrategy(s SellStrategy) &#123;</span><br><span class="line">	g.Strategy = s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *Goods)</span></span> SellPrice() <span class="type">float64</span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;原价值 &quot;</span>, g.Price , <span class="string">&quot; .&quot;</span>)</span><br><span class="line">	<span class="keyword">return</span> g.Strategy.GetPrice(g.Price)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	nike := Goods&#123;</span><br><span class="line">		Price: <span class="number">200.0</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//上午 ，商场执行策略A</span></span><br><span class="line">	nike.SetStrategy(<span class="built_in">new</span>(StrategyA))</span><br><span class="line">	fmt.Println(<span class="string">&quot;上午nike鞋卖&quot;</span>, nike.SellPrice())</span><br><span class="line"></span><br><span class="line">	<span class="comment">//下午， 商场执行策略B</span></span><br><span class="line">	nike.SetStrategy(<span class="built_in">new</span>(StrategyB))</span><br><span class="line">	fmt.Println(<span class="string">&quot;下午nike鞋卖&quot;</span>, nike.SellPrice())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>结果:</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">原价值  200  .</span><br><span class="line">执行策略A, 所有商品打八折</span><br><span class="line">上午nike鞋卖 160</span><br><span class="line">原价值  200  .</span><br><span class="line">执行策略B, 所有商品满200 减100</span><br><span class="line">下午nike鞋卖 100</span><br></pre></td></tr></table></figure></div>

<h3 id="5-3-3-策略模式的优缺点"><a href="#5-3-3-策略模式的优缺点" class="headerlink" title="5.3.3 策略模式的优缺点"></a>5.3.3 策略模式的优缺点</h3><p>优点：</p>
<p>(1) 策略模式提供了对“开闭原则”的完美支持，用户可以在不修改原有系统的基础上选择算法或行为，也可以灵活地增加新的算法或行为。</p>
<p>(2) 使用策略模式可以避免多重条件选择语句。多重条件选择语句不易维护，它把采取哪一种算法或行为的逻辑与算法或行为本身的实现逻辑混合在一起，将它们全部硬编码(Hard Coding)在一个庞大的多重条件选择语句中，比直接继承环境类的办法还要原始和落后。</p>
<p>(3) 策略模式提供了一种算法的复用机制。由于将算法单独提取出来封装在策略类中，因此不同的环境类可以方便地复用这些策略类。</p>
<p>缺点：</p>
<p>(1) 客户端必须知道所有的策略类，并自行决定使用哪一个策略类。这就意味着客户端必须理解这些算法的区别，以便适时选择恰当的算法。换言之，策略模式只适用于客户端知道所有的算法或行为的情况。</p>
<p>(2) 策略模式将造成系统产生很多具体策略类，任何细小的变化都将导致系统要增加一个新的具体策略类。</p>
<h3 id="5-3-4-适用场景"><a href="#5-3-4-适用场景" class="headerlink" title="5.3.4 适用场景"></a>5.3.4 适用场景</h3><p>​	准备一组算法，并将每一个算法封装起来，使得它们可以互换</p>
<h2 id="5-4-观察者模式"><a href="#5-4-观察者模式" class="headerlink" title="5.4 观察者模式"></a>5.4 观察者模式</h2><p>如果你需要在一个对象的状态被改变时，其他对象能作为其“观察者”而被通知，就可以使用观察者模式。</p>
<p>我们将自身的状态改变就会通知给其他对象的对象称为“发布者”，关注发布者状态变化的对象则称为“订阅者”。</p>
<h3 id="解决-1"><a href="#解决-1" class="headerlink" title="解决"></a>解决</h3><p>请看以下代码：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> observer</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 发布者</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Subject <span class="keyword">struct</span> &#123;</span><br><span class="line">  observers []Observer</span><br><span class="line">  content   <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewSubject</span><span class="params">()</span></span> *Subject &#123;</span><br><span class="line">  <span class="keyword">return</span> &amp;Subject&#123;</span><br><span class="line">    observers: <span class="built_in">make</span>([]Observer, <span class="number">0</span>),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加订阅者</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Subject)</span></span> AddObserver(o Observer) &#123;</span><br><span class="line">  s.observers = <span class="built_in">append</span>(s.observers, o)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 改变发布者的状态</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Subject)</span></span> UpdateContext(content <span class="type">string</span>) &#123;</span><br><span class="line">  s.content = content</span><br><span class="line">  s.notify()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通知订阅者接口</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Observer <span class="keyword">interface</span> &#123;</span><br><span class="line">  Do(*Subject)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Subject)</span></span> notify() &#123;</span><br><span class="line">  <span class="keyword">for</span> _, o := <span class="keyword">range</span> s.observers &#123;</span><br><span class="line">    o.Do(s)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 订阅者</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Reader <span class="keyword">struct</span> &#123;</span><br><span class="line">  name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewReader</span><span class="params">(name <span class="type">string</span>)</span></span> *Reader &#123;</span><br><span class="line">  <span class="keyword">return</span> &amp;Reader&#123;</span><br><span class="line">    name: name,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *Reader)</span></span> Do(s *Subject) &#123;</span><br><span class="line">  fmt.Println(r.name + <span class="string">&quot; get &quot;</span> + s.content)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>很简单，我们只要实现一个通知notify方法，在发布者的状态改变时执行即可。</p>
<p>测试代码：</p>
<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> observer</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleObserver</span><span class="params">()</span></span> &#123;</span><br><span class="line">  subject := NewSubject()</span><br><span class="line"></span><br><span class="line">  boy := NewReader(<span class="string">&quot;小明&quot;</span>)</span><br><span class="line">  girl := NewReader(<span class="string">&quot;小美&quot;</span>)</span><br><span class="line"></span><br><span class="line">  subject.AddObserver(boy)</span><br><span class="line">  subject.AddObserver(girl)</span><br><span class="line"></span><br><span class="line">  subject.UpdateContext(<span class="string">&quot;hi~&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Output:</span></span><br><span class="line">  <span class="comment">// 小明 get hi~</span></span><br><span class="line">  <span class="comment">// 小美 get hi~</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h3 id="观察者模式的优缺点"><a href="#观察者模式的优缺点" class="headerlink" title="观察者模式的优缺点"></a>观察者模式的优缺点</h3><p>优点：</p>
<p>(1) 观察者模式可以实现表示层和数据逻辑层的分离，定义了稳定的消息更新传递机制，并抽象了更新接口，使得可以有各种各样不同的表示层充当具体观察者角色。</p>
<p>(2) 观察者模式在观察目标和观察者之间建立一个抽象的耦合。观察目标只需要维持一个抽象观察者的集合，无须了解其具体观察者。由于观察目标和观察者没有紧密地耦合在一起，因此它们可以属于不同的抽象化层次。</p>
<p>(3) 观察者模式支持广播通信，观察目标会向所有已注册的观察者对象发送通知，简化了一对多系统设计的难度。</p>
<p>(4) 观察者模式满足“开闭原则”的要求，增加新的具体观察者无须修改原有系统代码，在具体观察者与观察目标之间不存在关联关系的情况下，增加新的观察目标也很方便。</p>
<p>缺点：</p>
<p>(1) 如果一个观察目标对象有很多直接和间接观察者，将所有的观察者都通知到会花费很多时间。</p>
<p>(2) 如果在观察者和观察目标之间存在循环依赖，观察目标会触发它们之间进行循环调用，可能导致系统崩溃。</p>
<p>(3) 观察者模式没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的，而仅仅只是知道观察目标发生了变化。</p>
<h3 id="适用场景-1"><a href="#适用场景-1" class="headerlink" title="适用场景"></a>适用场景</h3><p>​	(1) 一个抽象模型有两个方面，其中一个方面依赖于另一个方面，将这两个方面封装在独立的对象中使它们可以各自独立地改变和复用。</p>
<p>​	(2) 一个对象的改变将导致一个或多个其他对象也发生改变，而并不知道具体有多少对象将发生改变，也不知道这些对象是谁。</p>
<p>​	(3) 需要在系统中创建一个触发链，A对象的行为将影响B对象，B对象的行为将影响C对象……，可以使用观察者模式创建一种链式触发机制。</p>

		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> GO设计模式</li>
        <li><strong>作者:</strong> 纸鸢</li>
        <li><strong>创建于
                :</strong> 2023-03-25 11:43:58</li>
        
            <li>
                <strong>更新于
                    :</strong> 2023-05-27 03:46:58
            </li>
        
        <li>
            <strong>链接:</strong> https://www.youandgentleness.cn/2023/03/25/GO设计模式/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#设计模式</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2023/03/29/JWT%E8%AF%A6%E8%A7%A3/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">JWT详解</span>
						<span class="post-nav-item">上一篇</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2023/03/11/Go-context%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">Go-context源码剖析</span>
						<span class="post-nav-item">下一篇</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        评论
    </div>
    

        
            
    <div id="gitalk-container"></div>
    <script data-swup-reload-script
            src="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js"></script>
    <script data-swup-reload-script>

        function loadGitalk() {
            let __gitalk__pathname = decodeURI(location.pathname);
            const __gitalk__pathnameLength = __gitalk__pathname.length;
            const __gitalk__pathnameMaxLength = 50;
            if (__gitalk__pathnameLength > __gitalk__pathnameMaxLength) {
                __gitalk__pathname = __gitalk__pathname.substring(0, __gitalk__pathnameMaxLength - 3) + '...';
            }

            try {
                Gitalk && new Gitalk({
                    clientID: 'Ov23liq2s2cr3kgdwlfS',
                    clientSecret: '4b5fc10f347765c682cfbbe04d901abfb4c750dc',
                    repo: 'gitalk',
                    owner: 'zhouxing9454',
                    admin: ['zhouxing9454'],
                    id: __gitalk__pathname,
                    language: 'zh-CN',
                    proxy: 'https://hidden-silence-cde4.zhouxing9454.workers.dev/?https://github.com/login/oauth/access_token'
                }).render('gitalk-container');

            } catch (e) {
                window.Gitalk = null;
            }
        }

        if ('true') {
            const loadGitalkTimeout = setTimeout(() => {
                loadGitalk();
                clearTimeout(loadGitalkTimeout);
            }, 1000);
        } else {
            window.addEventListener('DOMContentLoaded', loadGitalk);
        }
    </script>



        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">目录</div>
		<div class="page-title">GO设计模式</div>
		<ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A2%98%E8%AE%B0"><span class="nav-text">题记</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%BF%B0"><span class="nav-text">一、设计模式概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%BB%8E%E4%BD%95%E8%80%8C%E6%9D%A5"><span class="nav-text">1.1设计模式从何而来</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8F%88%E4%BB%8E%E4%BD%95%E8%80%8C%E6%9D%A5"><span class="nav-text">1.2 软件设计模式又从何而来</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="nav-text">1.3 软件设计模式的种类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-text">1.4 软件设计模式的作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-%E5%A6%82%E4%BD%95%E5%AD%A6%E5%A5%BD%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="nav-text">1.5 如何学好设计模式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="nav-text">二、面向对象设计原则</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99"><span class="nav-text">1.单一职责原则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99%E8%AE%BE%E8%AE%A1"><span class="nav-text">2.开闭原则设计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-%E5%B9%B3%E9%93%BA%E5%BC%8F%E8%AE%BE%E8%AE%A1"><span class="nav-text">2.1 平铺式设计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99%E8%AE%BE%E8%AE%A1"><span class="nav-text">2.2 开闭原则设计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%84%8F%E4%B9%89"><span class="nav-text">2.3 接口的意义</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99"><span class="nav-text">3.里氏替换原则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE%E5%8E%9F%E5%88%99"><span class="nav-text">4.依赖倒置原则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E6%9C%80%E5%B0%91%E7%9F%A5%E9%81%93%E5%8E%9F%E5%88%99%EF%BC%88%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99%EF%BC%89"><span class="nav-text">5.最少知道原则（迪米特法则）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E6%8E%A5%E5%8F%A3%E5%88%86%E7%A6%BB%E5%8E%9F%E5%88%99"><span class="nav-text">6.接口分离原则</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">三、创建型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="nav-text">3.1简单工厂模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="nav-text">3.1.1 为什么需要工厂模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-2-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">3.1.2 简单工厂模式角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-3-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0"><span class="nav-text">3.1.3 简单工厂模式实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-4-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">3.1.4 简单工厂方法模式的优缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F"><span class="nav-text">3.2 工厂方法模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-1-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">3.2.1 工厂方法模式中的角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-2-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text">3.2.2 工厂方法模式的实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-3-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">3.2.3 工厂方法模式的优缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95"><span class="nav-text">3.3抽象工厂方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-1-%E4%BA%A7%E5%93%81%E6%97%8F%E4%B8%8E%E4%BA%A7%E5%93%81%E7%AD%89%E7%BA%A7%E7%BB%93%E6%9E%84"><span class="nav-text">3.3.1 产品族与产品等级结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-2-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">3.3.2 抽象工厂模式的角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-3-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text">3.3.3 抽象工厂方法模式的实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-4-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">3.3.4 抽象工厂模式的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-5-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">3.3.5 适用场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">3.4单例模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-1-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">3.4.1 单例模式中的角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-2-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E9%80%BB%E8%BE%91%E6%8E%A8%E6%BC%94%E5%AE%9E%E7%8E%B0"><span class="nav-text">3.4.2 单例模式逻辑推演实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-3-%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0"><span class="nav-text">3.4.3 线程安全的单例模式实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-4-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">3.4.4 单例模式的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-5-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">3.4.5 适用场景</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">四、结构型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="nav-text">4.1代理模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-1-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">4.1.1 代理模式中的角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-2-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E6%A1%88%E4%BE%8B%E5%AE%9E%E7%8E%B0"><span class="nav-text">4.1.2 代理模式案例实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-3-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E7%BA%AF%E7%90%86%E8%A7%A3%E6%A1%88%E4%BE%8B"><span class="nav-text">4.1.3 代理模式纯理解案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-4-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">4.1.4 代理模式的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-5-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">4.1.5 适用场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F"><span class="nav-text">4.2 装饰模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1-%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">4.2.1 装饰模式中的角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-2-%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">4.2.2 装饰模式中的代码实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-3-%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">4.2.3 装饰模式的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-3-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">4.2.3 适用场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="nav-text">4.3 适配器模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-1-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">4.3.1 适配器模式中的角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">4.3.2 适配器模式的代码实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-3-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">4.3.3 适配器模式优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-4-%E9%80%82%E5%BA%94%E5%9C%BA%E6%99%AF"><span class="nav-text">4.3.4 适应场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F"><span class="nav-text">4.4外观模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-1-%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E4%B8%AD%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">4.4.1 外观模式中角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-2-%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">4.4.2 外观模式的代码实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-3-%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%A1%88%E4%BE%8B"><span class="nav-text">4.4.3 外观模式的案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-4-%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">4.4.4 外观模式的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-5-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">4.4.5 适用场景</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">五、行为型模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F"><span class="nav-text">5.1模板方法模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-1-%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">5.1.1 模板方法模式中的角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-2-%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E6%A1%88%E4%BE%8B"><span class="nav-text">5.1.2 模板方法模式案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-3-%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">5.1.3 模板方法的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-4-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">5.1.4 适用场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F"><span class="nav-text">5.2命令模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3"><span class="nav-text">解决</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">命令模式的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">适用场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F"><span class="nav-text">5.3策略模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-1-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E4%B8%AD%E7%9A%84%E8%A7%92%E8%89%B2%E5%92%8C%E8%81%8C%E8%B4%A3"><span class="nav-text">5.3.1 策略模式中的角色和职责</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-2-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E6%A1%88%E4%BE%8B"><span class="nav-text">5.3.2 策略模式案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-3-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">5.3.3 策略模式的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-4-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">5.3.4 适用场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="nav-text">5.4 观察者模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-1"><span class="nav-text">解决</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">观察者模式的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="nav-text">适用场景</span></a></li></ol></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-cog fa-spin"></i>&nbsp;&nbsp;<a href="/">纸鸢</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        共撰写了 43 篇文章
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
            <div class="icp-info my-1"><a target="_blank" rel="nofollow" href="
                
                    https://beian.miit.gov.cn/
                
                ">浙ICP备2022034029号</a></div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
            
                
        
                
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="站内搜索您需要的内容..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>


<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Swup.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupSlideTheme.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScriptsPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupProgressPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupScrollPlugin.min.js" ></script><script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/SwupPreloadPlugin.min.js" ></script>
<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	<script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/imageViewer.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/utils.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/main.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/navbarShrink.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/scrollTopBottom.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/lightDarkSwitch.js" ></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/categoryList.js" ></script>


    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/localSearch.js" ></script>



    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/codeBlock.js" ></script>



    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/lazyload.js" ></script>



    <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/runtime.js" ></script>
    <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/odometer.min.js" ></script>
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/assets/odometer-theme-minimal.css">



  <script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/Typed.min.js" ></script>
  <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/typed.js" ></script>










    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/tools/tocToggle.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/toc.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/tabs.js" data-swup-reload-script></script>


<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/moment-with-locales.min.js" data-swup-reload-script></script>
<script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/essays.js" data-swup-reload-script></script>




    <script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/layouts/bookmarkNav.js" ></script>

	
	<div id="aplayer"></div>
<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/libs/APlayer.min.js" ></script>
<script  src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.2/files/source/js/build/plugins/aplayer.js" ></script>

	
</body>

</html>


<script type="text/javascript" src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/love.js"></script>
<script type="text/javascript" src="https://blog-1314857283.cos.ap-shanghai.myqcloud.com/FunnyTitle.js"></script>